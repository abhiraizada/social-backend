{"{\"assumptions\":{},\"sourceRoot\":\"/Users/prashant/Desktop/social-backend/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/prashant/Desktop/social-backend\",\"filename\":\"/Users/prashant/Desktop/social-backend/server.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/prashant/Desktop/social-backend\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.20.2:development":{"value":{"code":"import 'dotenv/config';\nimport cors from 'cors';\nimport express from 'express';\nvar bodyParser = require('body-parser');\nconst connectDB = require(\"./config/db\");\nconst jwt = require(\"jsonwebtoken\");\nconst qrcode = require(\"qrcode\");\nconst sseRoute = require(\"./routes/sse\");\nvar urlencodedParser = bodyParser.urlencoded({\n  extended: false\n});\n// app.use(express.static('public'));  \nconst app = express();\nconnectDB();\napp.use(express.json({\n  extended: false\n}));\napp.use(cors());\napp.get('/', (req, res) => {\n  console.log('res is ', res);\n  res.send('Hello World!');\n});\napp.post('/post', (req, res) => {\n  res.json({\n    success: true\n  });\n});\napp.use(function (req, res, next) {\n  res.flush = function () {/* Do nothing */};\n  next();\n});\napp.use(sseRoute);\napp.use('/auth', require(\"./routes/auth\"));\napp.use('/qr', require(\"./routes/qr\"));\napp.use('/order', require(\"./routes/order\"));\napp.use('/seq', require(\"./routes/order\"));\napp.listen(process.env.PORT, () => console.log(`Example app listening on port 3000!`));\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3JzIiwiZXhwcmVzcyIsImJvZHlQYXJzZXIiLCJyZXF1aXJlIiwiY29ubmVjdERCIiwiand0IiwicXJjb2RlIiwic3NlUm91dGUiLCJ1cmxlbmNvZGVkUGFyc2VyIiwidXJsZW5jb2RlZCIsImV4dGVuZGVkIiwiYXBwIiwidXNlIiwianNvbiIsImdldCIsInJlcSIsInJlcyIsImNvbnNvbGUiLCJsb2ciLCJzZW5kIiwicG9zdCIsInN1Y2Nlc3MiLCJuZXh0IiwiZmx1c2giLCJsaXN0ZW4iLCJwcm9jZXNzIiwiZW52IiwiUE9SVCJdLCJzb3VyY2VSb290IjoiL1VzZXJzL3ByYXNoYW50L0Rlc2t0b3Avc29jaWFsLWJhY2tlbmQvIiwic291cmNlcyI6WyJzZXJ2ZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICdkb3RlbnYvY29uZmlnJztcbmltcG9ydCBjb3JzIGZyb20gJ2NvcnMnO1xuaW1wb3J0IGV4cHJlc3MgZnJvbSAnZXhwcmVzcyc7XG52YXIgYm9keVBhcnNlciA9IHJlcXVpcmUoJ2JvZHktcGFyc2VyJyk7ICBcbmNvbnN0IGNvbm5lY3REQiA9IHJlcXVpcmUoXCIuL2NvbmZpZy9kYlwiKTtcbmNvbnN0IGp3dCA9IHJlcXVpcmUoXCJqc29ud2VidG9rZW5cIik7XG5jb25zdCBxcmNvZGUgPSByZXF1aXJlKFwicXJjb2RlXCIpO1xuY29uc3Qgc3NlUm91dGUgPSByZXF1aXJlKFwiLi9yb3V0ZXMvc3NlXCIpO1xuXG5cbnZhciB1cmxlbmNvZGVkUGFyc2VyID0gYm9keVBhcnNlci51cmxlbmNvZGVkKHsgZXh0ZW5kZWQ6IGZhbHNlIH0pICBcbi8vIGFwcC51c2UoZXhwcmVzcy5zdGF0aWMoJ3B1YmxpYycpKTsgIFxuY29uc3QgYXBwID0gZXhwcmVzcygpO1xuY29ubmVjdERCKClcblxuYXBwLnVzZShleHByZXNzLmpzb24oeyBleHRlbmRlZDogZmFsc2UgfSkpO1xuYXBwLnVzZShjb3JzKCkpO1xuXG5hcHAuZ2V0KCcvJywgKHJlcSwgcmVzKSA9PiB7XG4gIGNvbnNvbGUubG9nKCdyZXMgaXMgJyxyZXMpXG4gIHJlcy5zZW5kKCdIZWxsbyBXb3JsZCEnKTtcbn0pO1xuYXBwLnBvc3QoJy9wb3N0JywocmVxLHJlcyk9PntcbiAgICByZXMuanNvbih7c3VjY2Vzczp0cnVlfSlcbn0pXG5hcHAudXNlKGZ1bmN0aW9uIChyZXEsIHJlcywgbmV4dCkge1xuICByZXMuZmx1c2ggPSBmdW5jdGlvbiAoKSB7IC8qIERvIG5vdGhpbmcgKi8gfVxuICBuZXh0KCk7XG59KVxuYXBwLnVzZShzc2VSb3V0ZSk7XG5hcHAudXNlKCcvYXV0aCcscmVxdWlyZShcIi4vcm91dGVzL2F1dGhcIikpO1xuYXBwLnVzZSgnL3FyJyxyZXF1aXJlKFwiLi9yb3V0ZXMvcXJcIikpO1xuYXBwLnVzZSgnL29yZGVyJyxyZXF1aXJlKFwiLi9yb3V0ZXMvb3JkZXJcIikpO1xuYXBwLnVzZSgnL3NlcScscmVxdWlyZShcIi4vcm91dGVzL29yZGVyXCIpKTtcbmFwcC5saXN0ZW4ocHJvY2Vzcy5lbnYuUE9SVCwgKCkgPT5cbiAgY29uc29sZS5sb2coYEV4YW1wbGUgYXBwIGxpc3RlbmluZyBvbiBwb3J0IDMwMDAhYCksXG4pOyJdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxlQUFlO0FBQ3RCLE9BQU9BLElBQUksTUFBTSxNQUFNO0FBQ3ZCLE9BQU9DLE9BQU8sTUFBTSxTQUFTO0FBQzdCLElBQUlDLFVBQVUsR0FBR0MsT0FBTyxDQUFDLGFBQWEsQ0FBQztBQUN2QyxNQUFNQyxTQUFTLEdBQUdELE9BQU8sQ0FBQyxhQUFhLENBQUM7QUFDeEMsTUFBTUUsR0FBRyxHQUFHRixPQUFPLENBQUMsY0FBYyxDQUFDO0FBQ25DLE1BQU1HLE1BQU0sR0FBR0gsT0FBTyxDQUFDLFFBQVEsQ0FBQztBQUNoQyxNQUFNSSxRQUFRLEdBQUdKLE9BQU8sQ0FBQyxjQUFjLENBQUM7QUFHeEMsSUFBSUssZ0JBQWdCLEdBQUdOLFVBQVUsQ0FBQ08sVUFBVSxDQUFDO0VBQUVDLFFBQVEsRUFBRTtBQUFNLENBQUMsQ0FBQztBQUNqRTtBQUNBLE1BQU1DLEdBQUcsR0FBR1YsT0FBTyxFQUFFO0FBQ3JCRyxTQUFTLEVBQUU7QUFFWE8sR0FBRyxDQUFDQyxHQUFHLENBQUNYLE9BQU8sQ0FBQ1ksSUFBSSxDQUFDO0VBQUVILFFBQVEsRUFBRTtBQUFNLENBQUMsQ0FBQyxDQUFDO0FBQzFDQyxHQUFHLENBQUNDLEdBQUcsQ0FBQ1osSUFBSSxFQUFFLENBQUM7QUFFZlcsR0FBRyxDQUFDRyxHQUFHLENBQUMsR0FBRyxFQUFFLENBQUNDLEdBQUcsRUFBRUMsR0FBRyxLQUFLO0VBQ3pCQyxPQUFPLENBQUNDLEdBQUcsQ0FBQyxTQUFTLEVBQUNGLEdBQUcsQ0FBQztFQUMxQkEsR0FBRyxDQUFDRyxJQUFJLENBQUMsY0FBYyxDQUFDO0FBQzFCLENBQUMsQ0FBQztBQUNGUixHQUFHLENBQUNTLElBQUksQ0FBQyxPQUFPLEVBQUMsQ0FBQ0wsR0FBRyxFQUFDQyxHQUFHLEtBQUc7RUFDeEJBLEdBQUcsQ0FBQ0gsSUFBSSxDQUFDO0lBQUNRLE9BQU8sRUFBQztFQUFJLENBQUMsQ0FBQztBQUM1QixDQUFDLENBQUM7QUFDRlYsR0FBRyxDQUFDQyxHQUFHLENBQUMsVUFBVUcsR0FBRyxFQUFFQyxHQUFHLEVBQUVNLElBQUksRUFBRTtFQUNoQ04sR0FBRyxDQUFDTyxLQUFLLEdBQUcsWUFBWSxDQUFFLGlCQUFrQjtFQUM1Q0QsSUFBSSxFQUFFO0FBQ1IsQ0FBQyxDQUFDO0FBQ0ZYLEdBQUcsQ0FBQ0MsR0FBRyxDQUFDTCxRQUFRLENBQUM7QUFDakJJLEdBQUcsQ0FBQ0MsR0FBRyxDQUFDLE9BQU8sRUFBQ1QsT0FBTyxDQUFDLGVBQWUsQ0FBQyxDQUFDO0FBQ3pDUSxHQUFHLENBQUNDLEdBQUcsQ0FBQyxLQUFLLEVBQUNULE9BQU8sQ0FBQyxhQUFhLENBQUMsQ0FBQztBQUNyQ1EsR0FBRyxDQUFDQyxHQUFHLENBQUMsUUFBUSxFQUFDVCxPQUFPLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztBQUMzQ1EsR0FBRyxDQUFDQyxHQUFHLENBQUMsTUFBTSxFQUFDVCxPQUFPLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztBQUN6Q1EsR0FBRyxDQUFDYSxNQUFNLENBQUNDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxJQUFJLEVBQUUsTUFDM0JWLE9BQU8sQ0FBQ0MsR0FBRyxDQUFFLHFDQUFvQyxDQUFDLENBQ25EIn0=","map":{"version":3,"names":["cors","express","bodyParser","require","connectDB","jwt","qrcode","sseRoute","urlencodedParser","urlencoded","extended","app","use","json","get","req","res","console","log","send","post","success","next","flush","listen","process","env","PORT"],"sourceRoot":"/Users/prashant/Desktop/social-backend/","sources":["server.js"],"sourcesContent":["import 'dotenv/config';\nimport cors from 'cors';\nimport express from 'express';\nvar bodyParser = require('body-parser');  \nconst connectDB = require(\"./config/db\");\nconst jwt = require(\"jsonwebtoken\");\nconst qrcode = require(\"qrcode\");\nconst sseRoute = require(\"./routes/sse\");\n\n\nvar urlencodedParser = bodyParser.urlencoded({ extended: false })  \n// app.use(express.static('public'));  \nconst app = express();\nconnectDB()\n\napp.use(express.json({ extended: false }));\napp.use(cors());\n\napp.get('/', (req, res) => {\n  console.log('res is ',res)\n  res.send('Hello World!');\n});\napp.post('/post',(req,res)=>{\n    res.json({success:true})\n})\napp.use(function (req, res, next) {\n  res.flush = function () { /* Do nothing */ }\n  next();\n})\napp.use(sseRoute);\napp.use('/auth',require(\"./routes/auth\"));\napp.use('/qr',require(\"./routes/qr\"));\napp.use('/order',require(\"./routes/order\"));\napp.use('/seq',require(\"./routes/order\"));\napp.listen(process.env.PORT, () =>\n  console.log(`Example app listening on port 3000!`),\n);"],"mappings":"AAAA,OAAO,eAAe;AACtB,OAAOA,IAAI,MAAM,MAAM;AACvB,OAAOC,OAAO,MAAM,SAAS;AAC7B,IAAIC,UAAU,GAAGC,OAAO,CAAC,aAAa,CAAC;AACvC,MAAMC,SAAS,GAAGD,OAAO,CAAC,aAAa,CAAC;AACxC,MAAME,GAAG,GAAGF,OAAO,CAAC,cAAc,CAAC;AACnC,MAAMG,MAAM,GAAGH,OAAO,CAAC,QAAQ,CAAC;AAChC,MAAMI,QAAQ,GAAGJ,OAAO,CAAC,cAAc,CAAC;AAGxC,IAAIK,gBAAgB,GAAGN,UAAU,CAACO,UAAU,CAAC;EAAEC,QAAQ,EAAE;AAAM,CAAC,CAAC;AACjE;AACA,MAAMC,GAAG,GAAGV,OAAO,EAAE;AACrBG,SAAS,EAAE;AAEXO,GAAG,CAACC,GAAG,CAACX,OAAO,CAACY,IAAI,CAAC;EAAEH,QAAQ,EAAE;AAAM,CAAC,CAAC,CAAC;AAC1CC,GAAG,CAACC,GAAG,CAACZ,IAAI,EAAE,CAAC;AAEfW,GAAG,CAACG,GAAG,CAAC,GAAG,EAAE,CAACC,GAAG,EAAEC,GAAG,KAAK;EACzBC,OAAO,CAACC,GAAG,CAAC,SAAS,EAACF,GAAG,CAAC;EAC1BA,GAAG,CAACG,IAAI,CAAC,cAAc,CAAC;AAC1B,CAAC,CAAC;AACFR,GAAG,CAACS,IAAI,CAAC,OAAO,EAAC,CAACL,GAAG,EAACC,GAAG,KAAG;EACxBA,GAAG,CAACH,IAAI,CAAC;IAACQ,OAAO,EAAC;EAAI,CAAC,CAAC;AAC5B,CAAC,CAAC;AACFV,GAAG,CAACC,GAAG,CAAC,UAAUG,GAAG,EAAEC,GAAG,EAAEM,IAAI,EAAE;EAChCN,GAAG,CAACO,KAAK,GAAG,YAAY,CAAE,iBAAkB;EAC5CD,IAAI,EAAE;AACR,CAAC,CAAC;AACFX,GAAG,CAACC,GAAG,CAACL,QAAQ,CAAC;AACjBI,GAAG,CAACC,GAAG,CAAC,OAAO,EAACT,OAAO,CAAC,eAAe,CAAC,CAAC;AACzCQ,GAAG,CAACC,GAAG,CAAC,KAAK,EAACT,OAAO,CAAC,aAAa,CAAC,CAAC;AACrCQ,GAAG,CAACC,GAAG,CAAC,QAAQ,EAACT,OAAO,CAAC,gBAAgB,CAAC,CAAC;AAC3CQ,GAAG,CAACC,GAAG,CAAC,MAAM,EAACT,OAAO,CAAC,gBAAgB,CAAC,CAAC;AACzCQ,GAAG,CAACa,MAAM,CAACC,OAAO,CAACC,GAAG,CAACC,IAAI,EAAE,MAC3BV,OAAO,CAACC,GAAG,CAAE,qCAAoC,CAAC,CACnD"}},"mtime":1671425031854},"{\"assumptions\":{},\"sourceRoot\":\"/Users/prashant/Desktop/social-backend/config/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/prashant/Desktop/social-backend\",\"filename\":\"/Users/prashant/Desktop/social-backend/config/db.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/prashant/Desktop/social-backend\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.20.2:development":{"value":{"code":"const mongoose = require('mongoose');\nrequire('dotenv').config();\nconst db = process.env.MONGO_URI;\nconst connectDb = async () => {\n  try {\n    await mongoose.connect(db, {\n      useNewUrlParser: true,\n      useUnifiedTopology: true\n    });\n    console.log('Db Connected');\n  } catch (err) {\n    console.error(err.message);\n    process.exit(1);\n  }\n};\nmodule.exports = connectDb;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtb25nb29zZSIsInJlcXVpcmUiLCJjb25maWciLCJkYiIsInByb2Nlc3MiLCJlbnYiLCJNT05HT19VUkkiLCJjb25uZWN0RGIiLCJjb25uZWN0IiwidXNlTmV3VXJsUGFyc2VyIiwidXNlVW5pZmllZFRvcG9sb2d5IiwiY29uc29sZSIsImxvZyIsImVyciIsImVycm9yIiwibWVzc2FnZSIsImV4aXQiLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvcHJhc2hhbnQvRGVza3RvcC9zb2NpYWwtYmFja2VuZC9jb25maWcvIiwic291cmNlcyI6WyJkYi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBtb25nb29zZSA9IHJlcXVpcmUoJ21vbmdvb3NlJyk7XG5cbnJlcXVpcmUoJ2RvdGVudicpLmNvbmZpZygpXG5jb25zdCBkYiA9IHByb2Nlc3MuZW52Lk1PTkdPX1VSSTtcblxuY29uc3QgY29ubmVjdERiID0gYXN5bmMoKSA9PntcbiAgICB0cnl7XG4gICAgICAgIGF3YWl0IG1vbmdvb3NlLmNvbm5lY3QoZGIse1xuICAgICAgICAgICAgdXNlTmV3VXJsUGFyc2VyOiB0cnVlLCBcbiAgICAgICAgICAgIHVzZVVuaWZpZWRUb3BvbG9neTogdHJ1ZSxcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnNvbGUubG9nKCdEYiBDb25uZWN0ZWQnKTtcbiAgICB9XG4gICAgY2F0Y2goZXJyKXtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnIubWVzc2FnZSk7XG4gICAgICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGNvbm5lY3REYjsiXSwibWFwcGluZ3MiOiJBQUFBLE1BQU1BLFFBQVEsR0FBR0MsT0FBTyxDQUFDLFVBQVUsQ0FBQztBQUVwQ0EsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDQyxNQUFNLEVBQUU7QUFDMUIsTUFBTUMsRUFBRSxHQUFHQyxPQUFPLENBQUNDLEdBQUcsQ0FBQ0MsU0FBUztBQUVoQyxNQUFNQyxTQUFTLEdBQUcsWUFBVTtFQUN4QixJQUFHO0lBQ0MsTUFBTVAsUUFBUSxDQUFDUSxPQUFPLENBQUNMLEVBQUUsRUFBQztNQUN0Qk0sZUFBZSxFQUFFLElBQUk7TUFDckJDLGtCQUFrQixFQUFFO0lBQ3hCLENBQUMsQ0FBQztJQUNGQyxPQUFPLENBQUNDLEdBQUcsQ0FBQyxjQUFjLENBQUM7RUFDL0IsQ0FBQyxDQUNELE9BQU1DLEdBQUcsRUFBQztJQUNORixPQUFPLENBQUNHLEtBQUssQ0FBQ0QsR0FBRyxDQUFDRSxPQUFPLENBQUM7SUFDMUJYLE9BQU8sQ0FBQ1ksSUFBSSxDQUFDLENBQUMsQ0FBQztFQUNuQjtBQUNKLENBQUM7QUFFREMsTUFBTSxDQUFDQyxPQUFPLEdBQUdYLFNBQVMifQ==","map":{"version":3,"names":["mongoose","require","config","db","process","env","MONGO_URI","connectDb","connect","useNewUrlParser","useUnifiedTopology","console","log","err","error","message","exit","module","exports"],"sourceRoot":"/Users/prashant/Desktop/social-backend/config/","sources":["db.js"],"sourcesContent":["const mongoose = require('mongoose');\n\nrequire('dotenv').config()\nconst db = process.env.MONGO_URI;\n\nconst connectDb = async() =>{\n    try{\n        await mongoose.connect(db,{\n            useNewUrlParser: true, \n            useUnifiedTopology: true,\n        });\n        console.log('Db Connected');\n    }\n    catch(err){\n        console.error(err.message);\n        process.exit(1);\n    }\n};\n\nmodule.exports = connectDb;"],"mappings":"AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAU,CAAC;AAEpCA,OAAO,CAAC,QAAQ,CAAC,CAACC,MAAM,EAAE;AAC1B,MAAMC,EAAE,GAAGC,OAAO,CAACC,GAAG,CAACC,SAAS;AAEhC,MAAMC,SAAS,GAAG,YAAU;EACxB,IAAG;IACC,MAAMP,QAAQ,CAACQ,OAAO,CAACL,EAAE,EAAC;MACtBM,eAAe,EAAE,IAAI;MACrBC,kBAAkB,EAAE;IACxB,CAAC,CAAC;IACFC,OAAO,CAACC,GAAG,CAAC,cAAc,CAAC;EAC/B,CAAC,CACD,OAAMC,GAAG,EAAC;IACNF,OAAO,CAACG,KAAK,CAACD,GAAG,CAACE,OAAO,CAAC;IAC1BX,OAAO,CAACY,IAAI,CAAC,CAAC,CAAC;EACnB;AACJ,CAAC;AAEDC,MAAM,CAACC,OAAO,GAAGX,SAAS"}},"mtime":1668215961130},"{\"assumptions\":{},\"sourceRoot\":\"/Users/prashant/Desktop/social-backend/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/prashant/Desktop/social-backend\",\"filename\":\"/Users/prashant/Desktop/social-backend/routes/auth.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/prashant/Desktop/social-backend\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.20.2:development":{"value":{"code":"const User = require(\"../model/user\");\nconst express = require('express');\nconst router = express.Router();\nconst bcrypt = require('bcrypt');\nconst jwt = require(\"jsonwebtoken\");\nconst qrcode = require(\"qrcode\");\n// Register\n// ...\n\nrouter.post(\"/register\", async (req, res) => {\n  // Our register logic starts here\n\n  try {\n    // Get user input\n    console.log('req.body', req.body);\n    const {\n      name,\n      email,\n      password,\n      type\n    } = req.body;\n\n    // Validate user input\n    if (!(email && password && name)) {\n      res.status(400).send({\n        \"message\": \"All input is required\"\n      });\n    }\n\n    // check if user already exist\n    // Validate if user exist in our database\n    const oldUser = await User.findOne({\n      email\n    });\n    if (oldUser) {\n      return res.status(409).send(\"User Already Exist. Please Login\");\n    }\n\n    // Encrypt user password\n    let encryptedPassword = await bcrypt.hash(password, 10);\n\n    // Create user in our database\n    const user = await User.create({\n      name,\n      email: email.toLowerCase(),\n      // sanitize: convert email to lowercase\n      password: encryptedPassword,\n      type\n    });\n\n    // Create token\n    const token = jwt.sign({\n      user_id: user._id,\n      email\n    }, process.env.TOKEN_KEY, {\n      expiresIn: \"2h\"\n    });\n\n    // return new user\n    res.status(201).json({\n      token\n    });\n  } catch (err) {\n    console.log(err);\n  }\n  // Our register logic ends here\n});\n\n// ...\n;\n\n// Login\n// ...\n\nrouter.post(\"/login\", async (req, res) => {\n  // Our login logic starts here\n  try {\n    // Get user input\n    const {\n      email,\n      password\n    } = req.body;\n\n    // Validate user input\n    if (!(email && password)) {\n      res.status(400).json({\n        \"message\": \"All input is required\"\n      });\n    }\n\n    // Validate if user exist in our database\n    const user = await User.findOne({\n      email\n    });\n    if (user && (await bcrypt.compare(password, user.password))) {\n      // Create token\n      const token = jwt.sign({\n        user_id: user._id,\n        email\n      }, process.env.TOKEN_KEY, {\n        expiresIn: \"2h\"\n      });\n\n      // save user token\n      user.token = token;\n\n      // user\n      return res.status(200).json({\n        token\n      });\n    }\n    return res.status(400).send(\"Invalid Credentials\");\n  } catch (err) {\n    console.log(err);\n  }\n  // Our login logic ends here\n});\n\n// ...\n\nmodule.exports = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJVc2VyIiwicmVxdWlyZSIsImV4cHJlc3MiLCJyb3V0ZXIiLCJSb3V0ZXIiLCJiY3J5cHQiLCJqd3QiLCJxcmNvZGUiLCJwb3N0IiwicmVxIiwicmVzIiwiY29uc29sZSIsImxvZyIsImJvZHkiLCJuYW1lIiwiZW1haWwiLCJwYXNzd29yZCIsInR5cGUiLCJzdGF0dXMiLCJzZW5kIiwib2xkVXNlciIsImZpbmRPbmUiLCJlbmNyeXB0ZWRQYXNzd29yZCIsImhhc2giLCJ1c2VyIiwiY3JlYXRlIiwidG9Mb3dlckNhc2UiLCJ0b2tlbiIsInNpZ24iLCJ1c2VyX2lkIiwiX2lkIiwicHJvY2VzcyIsImVudiIsIlRPS0VOX0tFWSIsImV4cGlyZXNJbiIsImpzb24iLCJlcnIiLCJjb21wYXJlIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL3ByYXNoYW50L0Rlc2t0b3Avc29jaWFsLWJhY2tlbmQvcm91dGVzLyIsInNvdXJjZXMiOlsiYXV0aC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBVc2VyID0gcmVxdWlyZShcIi4uL21vZGVsL3VzZXJcIik7XG5jb25zdCBleHByZXNzID0gcmVxdWlyZSgnZXhwcmVzcycpXG5jb25zdCByb3V0ZXIgPSBleHByZXNzLlJvdXRlcigpO1xuY29uc3QgYmNyeXB0ID0gcmVxdWlyZSgnYmNyeXB0JylcbmNvbnN0IGp3dCA9IHJlcXVpcmUoXCJqc29ud2VidG9rZW5cIik7XG5jb25zdCBxcmNvZGUgPSByZXF1aXJlKFwicXJjb2RlXCIpO1xuLy8gUmVnaXN0ZXJcbi8vIC4uLlxuXG5yb3V0ZXIucG9zdChcIi9yZWdpc3RlclwiLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICAvLyBPdXIgcmVnaXN0ZXIgbG9naWMgc3RhcnRzIGhlcmVcbiAgXG4gICAgdHJ5IHtcbiAgICAgIC8vIEdldCB1c2VyIGlucHV0XG4gICAgICBjb25zb2xlLmxvZygncmVxLmJvZHknLHJlcS5ib2R5KVxuICAgICAgY29uc3QgeyBuYW1lLCBlbWFpbCwgcGFzc3dvcmQsIHR5cGUgfSA9IHJlcS5ib2R5O1xuICBcbiAgICAgIC8vIFZhbGlkYXRlIHVzZXIgaW5wdXRcbiAgICAgIGlmICghKGVtYWlsICYmIHBhc3N3b3JkICYmICBuYW1lICkpIHtcbiAgICAgICAgcmVzLnN0YXR1cyg0MDApLnNlbmQoe1wibWVzc2FnZVwiOlwiQWxsIGlucHV0IGlzIHJlcXVpcmVkXCJ9KTtcbiAgICAgIH1cbiAgXG4gICAgICAvLyBjaGVjayBpZiB1c2VyIGFscmVhZHkgZXhpc3RcbiAgICAgIC8vIFZhbGlkYXRlIGlmIHVzZXIgZXhpc3QgaW4gb3VyIGRhdGFiYXNlXG4gICAgICBjb25zdCBvbGRVc2VyID0gYXdhaXQgVXNlci5maW5kT25lKHsgZW1haWwgfSk7XG4gIFxuICAgICAgaWYgKG9sZFVzZXIpIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA5KS5zZW5kKFwiVXNlciBBbHJlYWR5IEV4aXN0LiBQbGVhc2UgTG9naW5cIik7XG4gICAgICB9XG4gIFxuICAgICAgLy8gRW5jcnlwdCB1c2VyIHBhc3N3b3JkXG4gICAgICBsZXQgZW5jcnlwdGVkUGFzc3dvcmQgPSBhd2FpdCBiY3J5cHQuaGFzaChwYXNzd29yZCwgMTApO1xuICBcbiAgICAgIC8vIENyZWF0ZSB1c2VyIGluIG91ciBkYXRhYmFzZVxuICAgICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXIuY3JlYXRlKHtcbiAgICAgICAgbmFtZSxcbiAgICAgICAgZW1haWw6IGVtYWlsLnRvTG93ZXJDYXNlKCksIC8vIHNhbml0aXplOiBjb252ZXJ0IGVtYWlsIHRvIGxvd2VyY2FzZVxuICAgICAgICBwYXNzd29yZDogZW5jcnlwdGVkUGFzc3dvcmQsXG4gICAgICAgIHR5cGVcbiAgICAgIH0pO1xuICBcbiAgICAgIC8vIENyZWF0ZSB0b2tlblxuICAgICAgY29uc3QgdG9rZW4gPSBqd3Quc2lnbihcbiAgICAgICAgeyB1c2VyX2lkOiB1c2VyLl9pZCwgZW1haWwgfSxcbiAgICAgICAgcHJvY2Vzcy5lbnYuVE9LRU5fS0VZLFxuICAgICAgICB7XG4gICAgICAgICAgZXhwaXJlc0luOiBcIjJoXCIsXG4gICAgICAgIH1cbiAgICAgICk7XG4gIFxuICAgICAgLy8gcmV0dXJuIG5ldyB1c2VyXG4gICAgICByZXMuc3RhdHVzKDIwMSkuanNvbih7IHRva2VuIH0pO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICB9XG4gICAgLy8gT3VyIHJlZ2lzdGVyIGxvZ2ljIGVuZHMgaGVyZVxuICB9KTtcbiAgXG4gIC8vIC4uLlxuICA7XG5cbi8vIExvZ2luXG4vLyAuLi5cblxucm91dGVyLnBvc3QoXCIvbG9naW5cIiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgLy8gT3VyIGxvZ2luIGxvZ2ljIHN0YXJ0cyBoZXJlXG4gICAgdHJ5IHtcbiAgICAgIC8vIEdldCB1c2VyIGlucHV0XG4gICAgICBjb25zdCB7IGVtYWlsLCBwYXNzd29yZCB9ID0gcmVxLmJvZHk7XG4gIFxuICAgICAgLy8gVmFsaWRhdGUgdXNlciBpbnB1dFxuICAgICAgaWYgKCEoZW1haWwgJiYgcGFzc3dvcmQpKSB7XG4gICAgICAgIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcIm1lc3NhZ2VcIjpcIkFsbCBpbnB1dCBpcyByZXF1aXJlZFwifSk7XG4gICAgICB9XG4gIFxuICAgICAgLy8gVmFsaWRhdGUgaWYgdXNlciBleGlzdCBpbiBvdXIgZGF0YWJhc2VcbiAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2VyLmZpbmRPbmUoeyBlbWFpbCB9KTtcbiAgXG4gICAgICBpZiAodXNlciAmJiAoYXdhaXQgYmNyeXB0LmNvbXBhcmUocGFzc3dvcmQsIHVzZXIucGFzc3dvcmQpKSkge1xuICAgICAgICAvLyBDcmVhdGUgdG9rZW5cbiAgICAgICAgY29uc3QgdG9rZW4gPSBqd3Quc2lnbihcbiAgICAgICAgICB7IHVzZXJfaWQ6IHVzZXIuX2lkLCBlbWFpbCB9LFxuICAgICAgICAgIHByb2Nlc3MuZW52LlRPS0VOX0tFWSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBleHBpcmVzSW46IFwiMmhcIixcbiAgICAgICAgICB9XG4gICAgICAgICk7XG4gIFxuICAgICAgICAvLyBzYXZlIHVzZXIgdG9rZW5cbiAgICAgICAgdXNlci50b2tlbiA9IHRva2VuO1xuICBcbiAgICAgICAgLy8gdXNlclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24oeyB0b2tlbiB9KTtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZChcIkludmFsaWQgQ3JlZGVudGlhbHNcIik7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgIH1cbiAgICAvLyBPdXIgbG9naW4gbG9naWMgZW5kcyBoZXJlXG4gIH0pO1xuICBcbiAgLy8gLi4uXG4gIFxuXG5tb2R1bGUuZXhwb3J0cyA9IHJvdXRlcjsiXSwibWFwcGluZ3MiOiJBQUFBLE1BQU1BLElBQUksR0FBR0MsT0FBTyxDQUFDLGVBQWUsQ0FBQztBQUNyQyxNQUFNQyxPQUFPLEdBQUdELE9BQU8sQ0FBQyxTQUFTLENBQUM7QUFDbEMsTUFBTUUsTUFBTSxHQUFHRCxPQUFPLENBQUNFLE1BQU0sRUFBRTtBQUMvQixNQUFNQyxNQUFNLEdBQUdKLE9BQU8sQ0FBQyxRQUFRLENBQUM7QUFDaEMsTUFBTUssR0FBRyxHQUFHTCxPQUFPLENBQUMsY0FBYyxDQUFDO0FBQ25DLE1BQU1NLE1BQU0sR0FBR04sT0FBTyxDQUFDLFFBQVEsQ0FBQztBQUNoQztBQUNBOztBQUVBRSxNQUFNLENBQUNLLElBQUksQ0FBQyxXQUFXLEVBQUUsT0FBT0MsR0FBRyxFQUFFQyxHQUFHLEtBQUs7RUFDekM7O0VBRUEsSUFBSTtJQUNGO0lBQ0FDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLFVBQVUsRUFBQ0gsR0FBRyxDQUFDSSxJQUFJLENBQUM7SUFDaEMsTUFBTTtNQUFFQyxJQUFJO01BQUVDLEtBQUs7TUFB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","map":{"version":3,"names":["User","require","express","router","Router","bcrypt","jwt","qrcode","post","req","res","console","log","body","name","email","password","type","status","send","oldUser","findOne","encryptedPassword","hash","user","create","toLowerCase","token","sign","user_id","_id","process","env","TOKEN_KEY","expiresIn","json","err","compare","module","exports"],"sourceRoot":"/Users/prashant/Desktop/social-backend/routes/","sources":["auth.js"],"sourcesContent":["const User = require(\"../model/user\");\nconst express = require('express')\nconst router = express.Router();\nconst bcrypt = require('bcrypt')\nconst jwt = require(\"jsonwebtoken\");\nconst qrcode = require(\"qrcode\");\n// Register\n// ...\n\nrouter.post(\"/register\", async (req, res) => {\n    // Our register logic starts here\n  \n    try {\n      // Get user input\n      console.log('req.body',req.body)\n      const { name, email, password, type } = req.body;\n  \n      // Validate user input\n      if (!(email && password &&  name )) {\n        res.status(400).send({\"message\":\"All input is required\"});\n      }\n  \n      // check if user already exist\n      // Validate if user exist in our database\n      const oldUser = await User.findOne({ email });\n  \n      if (oldUser) {\n        return res.status(409).send(\"User Already Exist. Please Login\");\n      }\n  \n      // Encrypt user password\n      let encryptedPassword = await bcrypt.hash(password, 10);\n  \n      // Create user in our database\n      const user = await User.create({\n        name,\n        email: email.toLowerCase(), // sanitize: convert email to lowercase\n        password: encryptedPassword,\n        type\n      });\n  \n      // Create token\n      const token = jwt.sign(\n        { user_id: user._id, email },\n        process.env.TOKEN_KEY,\n        {\n          expiresIn: \"2h\",\n        }\n      );\n  \n      // return new user\n      res.status(201).json({ token });\n    } catch (err) {\n      console.log(err);\n    }\n    // Our register logic ends here\n  });\n  \n  // ...\n  ;\n\n// Login\n// ...\n\nrouter.post(\"/login\", async (req, res) => {\n    // Our login logic starts here\n    try {\n      // Get user input\n      const { email, password } = req.body;\n  \n      // Validate user input\n      if (!(email && password)) {\n        res.status(400).json({\"message\":\"All input is required\"});\n      }\n  \n      // Validate if user exist in our database\n      const user = await User.findOne({ email });\n  \n      if (user && (await bcrypt.compare(password, user.password))) {\n        // Create token\n        const token = jwt.sign(\n          { user_id: user._id, email },\n          process.env.TOKEN_KEY,\n          {\n            expiresIn: \"2h\",\n          }\n        );\n  \n        // save user token\n        user.token = token;\n  \n        // user\n        return res.status(200).json({ token });\n      }\n      return res.status(400).send(\"Invalid Credentials\");\n    } catch (err) {\n      console.log(err);\n    }\n    // Our login logic ends here\n  });\n  \n  // ...\n  \n\nmodule.exports = router;"],"mappings":"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"}},"mtime":1668204155279},"{\"assumptions\":{},\"sourceRoot\":\"/Users/prashant/Desktop/social-backend/model/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/prashant/Desktop/social-backend\",\"filename\":\"/Users/prashant/Desktop/social-backend/model/user.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/prashant/Desktop/social-backend\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.20.2:development":{"value":{"code":"const mongoose = require(\"mongoose\");\nconst userSchema = new mongoose.Schema({\n  name: {\n    type: String,\n    required: true\n  },\n  email: {\n    type: String,\n    unique: true,\n    required: true\n  },\n  phoneNumber: {\n    type: String,\n    default: null\n  },\n  password: {\n    type: String,\n    required: true\n  },\n  type: {\n    type: String,\n    required: true\n  }\n}, {\n  timestamps: {\n    createdAt: 'created_at',\n    updatedAt: 'updated_at'\n  }\n});\nmodule.exports = mongoose.model(\"user\", userSchema);\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtb25nb29zZSIsInJlcXVpcmUiLCJ1c2VyU2NoZW1hIiwiU2NoZW1hIiwibmFtZSIsInR5cGUiLCJTdHJpbmciLCJyZXF1aXJlZCIsImVtYWlsIiwidW5pcXVlIiwicGhvbmVOdW1iZXIiLCJkZWZhdWx0IiwicGFzc3dvcmQiLCJ0aW1lc3RhbXBzIiwiY3JlYXRlZEF0IiwidXBkYXRlZEF0IiwibW9kdWxlIiwiZXhwb3J0cyIsIm1vZGVsIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvcHJhc2hhbnQvRGVza3RvcC9zb2NpYWwtYmFja2VuZC9tb2RlbC8iLCJzb3VyY2VzIjpbInVzZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgbW9uZ29vc2UgPSByZXF1aXJlKFwibW9uZ29vc2VcIik7XG5cbmNvbnN0IHVzZXJTY2hlbWEgPSBuZXcgbW9uZ29vc2UuU2NoZW1hKHtcbiAgICBuYW1lOiB7IHR5cGU6IFN0cmluZywgcmVxdWlyZWQ6IHRydWUsIH0sXG4gICAgZW1haWw6IHsgdHlwZTogU3RyaW5nLCB1bmlxdWU6IHRydWUsIHJlcXVpcmVkOiB0cnVlLCB9LFxuICAgIHBob25lTnVtYmVyOiB7IHR5cGU6IFN0cmluZyAsIGRlZmF1bHQ6IG51bGwgfSxcbiAgICBwYXNzd29yZDogeyB0eXBlOiBTdHJpbmcsIHJlcXVpcmVkOiB0cnVlLCB9LFxuICAgIHR5cGU6IHsgdHlwZTogU3RyaW5nLCByZXF1aXJlZDogdHJ1ZSwgfVxufSwgeyB0aW1lc3RhbXBzOiB7IGNyZWF0ZWRBdDogJ2NyZWF0ZWRfYXQnLCB1cGRhdGVkQXQ6ICd1cGRhdGVkX2F0JyB9IH0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vbmdvb3NlLm1vZGVsKFwidXNlclwiLCB1c2VyU2NoZW1hKTsiXSwibWFwcGluZ3MiOiJBQUFBLE1BQU1BLFFBQVEsR0FBR0MsT0FBTyxDQUFDLFVBQVUsQ0FBQztBQUVwQyxNQUFNQyxVQUFVLEdBQUcsSUFBSUYsUUFBUSxDQUFDRyxNQUFNLENBQUM7RUFDbkNDLElBQUksRUFBRTtJQUFFQyxJQUFJLEVBQUVDLE1BQU07SUFBRUMsUUFBUSxFQUFFO0VBQU0sQ0FBQztFQUN2Q0MsS0FBSyxFQUFFO0lBQUVILElBQUksRUFBRUMsTUFBTTtJQUFFRyxNQUFNLEVBQUUsSUFBSTtJQUFFRixRQUFRLEVBQUU7RUFBTSxDQUFDO0VBQ3RERyxXQUFXLEVBQUU7SUFBRUwsSUFBSSxFQUFFQyxNQUFNO0lBQUdLLE9BQU8sRUFBRTtFQUFLLENBQUM7RUFDN0NDLFFBQVEsRUFBRTtJQUFFUCxJQUFJLEVBQUVDLE1BQU07SUFBRUMsUUFBUSxFQUFFO0VBQU0sQ0FBQztFQUMzQ0YsSUFBSSxFQUFFO0lBQUVBLElBQUksRUFBRUMsTUFBTTtJQUFFQyxRQUFRLEVBQUU7RUFBTTtBQUMxQyxDQUFDLEVBQUU7RUFBRU0sVUFBVSxFQUFFO0lBQUVDLFNBQVMsRUFBRSxZQUFZO0lBQUVDLFNBQVMsRUFBRTtFQUFhO0FBQUUsQ0FBQyxDQUFDO0FBRXhFQyxNQUFNLENBQUNDLE9BQU8sR0FBR2pCLFFBQVEsQ0FBQ2tCLEtBQUssQ0FBQyxNQUFNLEVBQUVoQixVQUFVLENBQUMifQ==","map":{"version":3,"names":["mongoose","require","userSchema","Schema","name","type","String","required","email","unique","phoneNumber","default","password","timestamps","createdAt","updatedAt","module","exports","model"],"sourceRoot":"/Users/prashant/Desktop/social-backend/model/","sources":["user.js"],"sourcesContent":["const mongoose = require(\"mongoose\");\n\nconst userSchema = new mongoose.Schema({\n    name: { type: String, required: true, },\n    email: { type: String, unique: true, required: true, },\n    phoneNumber: { type: String , default: null },\n    password: { type: String, required: true, },\n    type: { type: String, required: true, }\n}, { timestamps: { createdAt: 'created_at', updatedAt: 'updated_at' } });\n\nmodule.exports = mongoose.model(\"user\", userSchema);"],"mappings":"AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAU,CAAC;AAEpC,MAAMC,UAAU,GAAG,IAAIF,QAAQ,CAACG,MAAM,CAAC;EACnCC,IAAI,EAAE;IAAEC,IAAI,EAAEC,MAAM;IAAEC,QAAQ,EAAE;EAAM,CAAC;EACvCC,KAAK,EAAE;IAAEH,IAAI,EAAEC,MAAM;IAAEG,MAAM,EAAE,IAAI;IAAEF,QAAQ,EAAE;EAAM,CAAC;EACtDG,WAAW,EAAE;IAAEL,IAAI,EAAEC,MAAM;IAAGK,OAAO,EAAE;EAAK,CAAC;EAC7CC,QAAQ,EAAE;IAAEP,IAAI,EAAEC,MAAM;IAAEC,QAAQ,EAAE;EAAM,CAAC;EAC3CF,IAAI,EAAE;IAAEA,IAAI,EAAEC,MAAM;IAAEC,QAAQ,EAAE;EAAM;AAC1C,CAAC,EAAE;EAAEM,UAAU,EAAE;IAAEC,SAAS,EAAE,YAAY;IAAEC,SAAS,EAAE;EAAa;AAAE,CAAC,CAAC;AAExEC,MAAM,CAACC,OAAO,GAAGjB,QAAQ,CAACkB,KAAK,CAAC,MAAM,EAAEhB,UAAU,CAAC"}},"mtime":1668204154247},"{\"assumptions\":{},\"sourceRoot\":\"/Users/prashant/Desktop/social-backend/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/prashant/Desktop/social-backend\",\"filename\":\"/Users/prashant/Desktop/social-backend/routes/qr.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/prashant/Desktop/social-backend\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.20.2:development":{"value":{"code":"const User = require(\"../model/user\");\nconst QRCode = require(\"../model/qrCode\");\nconst ConnectedDevice = require(\"../model/connectedDevice\");\nconst express = require('express');\nconst router = express.Router();\nconst jwt = require(\"jsonwebtoken\");\nconst QR = require(\"qrcode\");\nvar ObjectId = require('mongoose').Types.ObjectId;\nrouter.post(\"/generate\", async (req, res) => {\n  try {\n    console.log('body', req.body);\n    const {\n      userId\n    } = req.body;\n    console.log('userId', userId, req.body.userId);\n    // Validate user input\n    if (!userId) {\n      res.status(400).send(\"User Id is required\");\n    }\n    const user = await User.findById(userId);\n\n    // Validate is user exist\n    if (!user) {\n      res.status(400).send(\"User not found\");\n    }\n    const qrExist = await QRCode.findOne({\n      userId\n    });\n\n    // If qr exist, update disable to true and then create a new qr record\n    if (!qrExist) {\n      await QRCode.create({\n        userId\n      });\n    } else {\n      await QRCode.findOneAndUpdate({\n        userId\n      }, {\n        $set: {\n          disabled: true\n        }\n      });\n      await QRCode.create({\n        userId\n      });\n    }\n\n    // Generate encrypted data\n    const encryptedData = jwt.sign({\n      userId: user._id,\n      email: user.email\n    }, process.env.TOKEN_KEY, {\n      expiresIn: \"1d\"\n    });\n\n    // Generate qr code\n    const dataImage = await QR.toDataURL(encryptedData);\n\n    // Return qr code\n    return res.status(200).json({\n      dataImage\n    });\n  } catch (err) {\n    console.log(err);\n  }\n});\nrouter.post(\"/scan\", async (req, res) => {\n  try {\n    const {\n      token,\n      deviceInformation\n    } = req.body;\n    if (!token && !deviceInformation) {\n      res.status(400).send(\"Token and deviceInformation is required\");\n    }\n    const decoded = jwt.verify(token, process.env.TOKEN_KEY);\n    console.log('decoded', decoded);\n    const qrCode = await QRCode.findOne({\n      userId: decoded.user_id,\n      disabled: false\n    });\n    //   const qrCode = await QRCode.findOne({\n    //     userId: new ObjectId(decoded.user_id),\n    //     disabled: false,\n    //   });\n\n    if (!qrCode) {\n      res.status(400).send(\"QR Code not found\");\n    }\n    console.log('qrCode', qrCode);\n    const connectedDeviceData = {\n      userId: decoded.user_id,\n      qrCodeId: qrCode._id,\n      deviceName: deviceInformation.deviceName,\n      deviceModel: deviceInformation.deviceModel,\n      deviceOS: deviceInformation.deviceOS,\n      deviceVersion: deviceInformation.deviceVersion\n    };\n    const connectedDevice = await ConnectedDevice.create(connectedDeviceData);\n\n    // Update qr code\n    await QRCode.findOneAndUpdate({\n      _id: qrCode._id\n    }, {\n      isActive: true,\n      connectedDeviceId: connectedDevice._id,\n      lastUsedDate: new Date()\n    });\n\n    // Find user\n    const user = await User.findById(decoded.user_id);\n\n    // Create token\n    const authToken = jwt.sign({\n      user_id: user._id\n    }, process.env.TOKEN_KEY, {\n      expiresIn: \"2h\"\n    });\n\n    // Return token\n    return res.status(200).json({\n      token: authToken\n    });\n  } catch (err) {\n    console.log(err);\n  }\n});\nmodule.exports = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJVc2VyIiwicmVxdWlyZSIsIlFSQ29kZSIsIkNvbm5lY3RlZERldmljZSIsImV4cHJlc3MiLCJyb3V0ZXIiLCJSb3V0ZXIiLCJqd3QiLCJRUiIsIk9iamVjdElkIiwiVHlwZXMiLCJwb3N0IiwicmVxIiwicmVzIiwiY29uc29sZSIsImxvZyIsImJvZHkiLCJ1c2VySWQiLCJzdGF0dXMiLCJzZW5kIiwidXNlciIsImZpbmRCeUlkIiwicXJFeGlzdCIsImZpbmRPbmUiLCJjcmVhdGUiLCJmaW5kT25lQW5kVXBkYXRlIiwiJHNldCIsImRpc2FibGVkIiwiZW5jcnlwdGVkRGF0YSIsInNpZ24iLCJfaWQiLCJlbWFpbCIsInByb2Nlc3MiLCJlbnYiLCJUT0tFTl9LRVkiLCJleHBpcmVzSW4iLCJkYXRhSW1hZ2UiLCJ0b0RhdGFVUkwiLCJqc29uIiwiZXJyIiwidG9rZW4iLCJkZXZpY2VJbmZvcm1hdGlvbiIsImRlY29kZWQiLCJ2ZXJpZnkiLCJxckNvZGUiLCJ1c2VyX2lkIiwiY29ubmVjdGVkRGV2aWNlRGF0YSIsInFyQ29kZUlkIiwiZGV2aWNlTmFtZSIsImRldmljZU1vZGVsIiwiZGV2aWNlT1MiLCJkZXZpY2VWZXJzaW9uIiwiY29ubmVjdGVkRGV2aWNlIiwiaXNBY3RpdmUiLCJjb25uZWN0ZWREZXZpY2VJZCIsImxhc3RVc2VkRGF0ZSIsIkRhdGUiLCJhdXRoVG9rZW4iLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvcHJhc2hhbnQvRGVza3RvcC9zb2NpYWwtYmFja2VuZC9yb3V0ZXMvIiwic291cmNlcyI6WyJxci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBVc2VyID0gcmVxdWlyZShcIi4uL21vZGVsL3VzZXJcIik7XG5jb25zdCBRUkNvZGUgPSByZXF1aXJlKFwiLi4vbW9kZWwvcXJDb2RlXCIpO1xuY29uc3QgQ29ubmVjdGVkRGV2aWNlID0gcmVxdWlyZShcIi4uL21vZGVsL2Nvbm5lY3RlZERldmljZVwiKTtcbmNvbnN0IGV4cHJlc3MgPSByZXF1aXJlKCdleHByZXNzJylcbmNvbnN0IHJvdXRlciA9IGV4cHJlc3MuUm91dGVyKCk7XG5jb25zdCBqd3QgPSByZXF1aXJlKFwianNvbndlYnRva2VuXCIpO1xuY29uc3QgUVIgPSByZXF1aXJlKFwicXJjb2RlXCIpO1xudmFyIE9iamVjdElkID0gcmVxdWlyZSgnbW9uZ29vc2UnKS5UeXBlcy5PYmplY3RJZDtcblxucm91dGVyLnBvc3QoXCIvZ2VuZXJhdGVcIiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc29sZS5sb2coJ2JvZHknLHJlcS5ib2R5KVxuICAgICAgICBjb25zdCB7IHVzZXJJZCB9ID0gcmVxLmJvZHk7XG4gICAgICAgIGNvbnNvbGUubG9nKCd1c2VySWQnLHVzZXJJZCwgcmVxLmJvZHkudXNlcklkKVxuICAgICAgICAvLyBWYWxpZGF0ZSB1c2VyIGlucHV0XG4gICAgICAgIGlmICghdXNlcklkKSB7XG4gICAgICAgICAgICByZXMuc3RhdHVzKDQwMCkuc2VuZChcIlVzZXIgSWQgaXMgcmVxdWlyZWRcIik7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlci5maW5kQnlJZCh1c2VySWQpO1xuXG4gICAgICAgIC8vIFZhbGlkYXRlIGlzIHVzZXIgZXhpc3RcbiAgICAgICAgaWYgKCF1c2VyKSB7XG4gICAgICAgICAgICByZXMuc3RhdHVzKDQwMCkuc2VuZChcIlVzZXIgbm90IGZvdW5kXCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgcXJFeGlzdCA9IGF3YWl0IFFSQ29kZS5maW5kT25lKHsgdXNlcklkIH0pO1xuXG4gICAgICAgIC8vIElmIHFyIGV4aXN0LCB1cGRhdGUgZGlzYWJsZSB0byB0cnVlIGFuZCB0aGVuIGNyZWF0ZSBhIG5ldyBxciByZWNvcmRcbiAgICAgICAgaWYgKCFxckV4aXN0KSB7XG4gICAgICAgICAgICBhd2FpdCBRUkNvZGUuY3JlYXRlKHsgdXNlcklkIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYXdhaXQgUVJDb2RlLmZpbmRPbmVBbmRVcGRhdGUoeyB1c2VySWQgfSwgeyAkc2V0OiB7IGRpc2FibGVkOiB0cnVlIH0gfSk7XG4gICAgICAgICAgICBhd2FpdCBRUkNvZGUuY3JlYXRlKHsgdXNlcklkIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gR2VuZXJhdGUgZW5jcnlwdGVkIGRhdGFcbiAgICAgICAgY29uc3QgZW5jcnlwdGVkRGF0YSA9IGp3dC5zaWduKFxuICAgICAgICAgICAgeyB1c2VySWQ6IHVzZXIuX2lkLCBlbWFpbDogdXNlci5lbWFpbCB9LFxuICAgICAgICAgICAgcHJvY2Vzcy5lbnYuVE9LRU5fS0VZLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGV4cGlyZXNJbjogXCIxZFwiLFxuICAgICAgICAgICAgfVxuICAgICAgICApO1xuXG4gICAgICAgIC8vIEdlbmVyYXRlIHFyIGNvZGVcbiAgICAgICAgY29uc3QgZGF0YUltYWdlID0gYXdhaXQgUVIudG9EYXRhVVJMKGVuY3J5cHRlZERhdGEpO1xuXG4gICAgICAgIC8vIFJldHVybiBxciBjb2RlXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbih7IGRhdGFJbWFnZSB9KTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICB9XG59KTtcblxucm91dGVyLnBvc3QoXCIvc2NhblwiLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgeyB0b2tlbiwgZGV2aWNlSW5mb3JtYXRpb24gfSA9IHJlcS5ib2R5O1xuICBcbiAgICAgIGlmICghdG9rZW4gJiYgIWRldmljZUluZm9ybWF0aW9uKSB7XG4gICAgICAgIHJlcy5zdGF0dXMoNDAwKS5zZW5kKFwiVG9rZW4gYW5kIGRldmljZUluZm9ybWF0aW9uIGlzIHJlcXVpcmVkXCIpO1xuICAgICAgfVxuICBcbiAgICAgIGNvbnN0IGRlY29kZWQgPSBqd3QudmVyaWZ5KHRva2VuLCBwcm9jZXNzLmVudi5UT0tFTl9LRVkpO1xuICAgICAgY29uc29sZS5sb2coJ2RlY29kZWQnLGRlY29kZWQpXG4gICAgICBjb25zdCBxckNvZGUgPSBhd2FpdCBRUkNvZGUuZmluZE9uZSh7XG4gICAgICAgIHVzZXJJZDogZGVjb2RlZC51c2VyX2lkLFxuICAgICAgICBkaXNhYmxlZDogZmFsc2UsXG4gICAgICB9KTtcbiAgICAvLyAgIGNvbnN0IHFyQ29kZSA9IGF3YWl0IFFSQ29kZS5maW5kT25lKHtcbiAgICAvLyAgICAgdXNlcklkOiBuZXcgT2JqZWN0SWQoZGVjb2RlZC51c2VyX2lkKSxcbiAgICAvLyAgICAgZGlzYWJsZWQ6IGZhbHNlLFxuICAgIC8vICAgfSk7XG4gIFxuICAgICAgaWYgKCFxckNvZGUpIHtcbiAgICAgICAgcmVzLnN0YXR1cyg0MDApLnNlbmQoXCJRUiBDb2RlIG5vdCBmb3VuZFwiKTtcbiAgICAgIH1cbiAgICAgIGNvbnNvbGUubG9nKCdxckNvZGUnLCBxckNvZGUpXG4gICAgICBjb25zdCBjb25uZWN0ZWREZXZpY2VEYXRhID0ge1xuICAgICAgICB1c2VySWQ6IGRlY29kZWQudXNlcl9pZCxcbiAgICAgICAgcXJDb2RlSWQ6IHFyQ29kZS5faWQsXG4gICAgICAgIGRldmljZU5hbWU6IGRldmljZUluZm9ybWF0aW9uLmRldmljZU5hbWUsXG4gICAgICAgIGRldmljZU1vZGVsOiBkZXZpY2VJbmZvcm1hdGlvbi5kZXZpY2VNb2RlbCxcbiAgICAgICAgZGV2aWNlT1M6IGRldmljZUluZm9ybWF0aW9uLmRldmljZU9TLFxuICAgICAgICBkZXZpY2VWZXJzaW9uOiBkZXZpY2VJbmZvcm1hdGlvbi5kZXZpY2VWZXJzaW9uLFxuICAgICAgfTtcbiAgXG4gICAgICBjb25zdCBjb25uZWN0ZWREZXZpY2UgPSBhd2FpdCBDb25uZWN0ZWREZXZpY2UuY3JlYXRlKGNvbm5lY3RlZERldmljZURhdGEpO1xuICBcbiAgICAgIC8vIFVwZGF0ZSBxciBjb2RlXG4gICAgICBhd2FpdCBRUkNvZGUuZmluZE9uZUFuZFVwZGF0ZShcbiAgICAgICAgeyBfaWQ6IHFyQ29kZS5faWQgfSxcbiAgICAgICAge1xuICAgICAgICAgIGlzQWN0aXZlOiB0cnVlLFxuICAgICAgICAgIGNvbm5lY3RlZERldmljZUlkOiBjb25uZWN0ZWREZXZpY2UuX2lkLFxuICAgICAgICAgIGxhc3RVc2VkRGF0ZTogbmV3IERhdGUoKSxcbiAgICAgICAgfVxuICAgICAgKTtcbiAgXG4gICAgICAvLyBGaW5kIHVzZXJcbiAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2VyLmZpbmRCeUlkKGRlY29kZWQudXNlcl9pZCk7XG4gIFxuICAgICAgLy8gQ3JlYXRlIHRva2VuXG4gICAgICBjb25zdCBhdXRoVG9rZW4gPSBqd3Quc2lnbih7IHVzZXJfaWQ6IHVzZXIuX2lkIH0sIHByb2Nlc3MuZW52LlRPS0VOX0tFWSwge1xuICAgICAgICBleHBpcmVzSW46IFwiMmhcIixcbiAgICAgIH0pO1xuICBcbiAgICAgIC8vIFJldHVybiB0b2tlblxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgdG9rZW46IGF1dGhUb2tlbiB9KTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgfVxuICB9KTtcbiAgXG5tb2R1bGUuZXhwb3J0cyA9IHJvdXRlcjsiXSwibWFwcGluZ3MiOiJBQUFBLE1BQU1BLElBQUksR0FBR0MsT0FBTyxDQUFDLGVBQWUsQ0FBQztBQUNyQyxNQUFNQyxNQUFNLEdBQUdELE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQztBQUN6QyxNQUFNRSxlQUFlLEdBQUdGLE9BQU8sQ0FBQywwQkFBMEIsQ0FBQztBQUMzRCxNQUFNRyxPQUFPLEdBQUdILE9BQU8sQ0FBQyxTQUFTLENBQUM7QUFDbEMsTUFBTUksTUFBTSxHQUFHRCxPQUFPLENBQUNFLE1BQU0sRUFBRTtBQUMvQixNQUFNQyxHQUFHLEdBQUdOLE9BQU8sQ0FBQyxjQUFjLENBQUM7QUFDbkMsTUFBTU8sRUFBRSxHQUFHUCxPQUFPLENBQUMsUUFBUSxDQUFDO0FBQzVCLElBQUlRLFFBQVEsR0FBR1IsT0FBTyxDQUFDLFVBQVUsQ0FBQyxDQUFDUyxLQUFLLENBQUNELFFBQVE7QUFFakRKLE1BQU0sQ0FBQ00sSUFBSSxDQUFDLFdBQVcsRUFBRSxPQUFPQyxHQUFHLEVBQUVDLEdBQUcsS0FBSztFQUN6QyxJQUFJO0lBQ0FDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLE1BQU0sRUFBQ0gsR0FBRyxDQUFDSSxJQUFJLENBQUM7SUFDNUIsTUFBTTtNQUFFQztJQUFPLENBQUMsR0FBR0wsR0FBRyxDQUFDSSxJQUFJO0lBQzNCRixPQUFPLENBQUNDLEdBQUcsQ0FBQyxRQUFRLEVBQUNFLE1BQU0sRUFBRUwsR0FBRyxDQUFDSSxJQUFJLENBQUNDLE1BQU0sQ0FBQztJQUM3QztJQUNBLElBQUksQ0FBQ0EsTUFBTSxFQUFFO01BQ1RKLEdBQUcsQ0FBQ0ssTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUMscUJBQXFCLENBQUM7SUFDL0M7SUFFQSxNQUFNQyxJQUFJLEdBQUcsTUFBTXBCLElBQUksQ0FBQ3FCLFFBQVEsQ0FBQ0osTUFBTSxDQUFDOztJQUV4QztJQUNBLElBQUksQ0FBQ0csSUFBSSxFQUFFO01BQ1BQLEdBQUcsQ0FBQ0ssTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUMsZ0JBQWdCLENBQUM7SUFDMUM7SUFFQSxNQUFNRyxPQUFPLEdBQUcsTUFBTXBCLE1BQU0sQ0FBQ3FCLE9BQU8sQ0FBQztNQUFFTjtJQUFPLENBQUMsQ0FBQzs7SUFFaEQ7SUFDQSxJQUFJLENBQUNLLE9BQU8sRUFBRTtNQUNWLE1BQU1wQixNQUFNLENBQUNzQixNQUFNLENBQUM7UUFBRVA7TUFBTyxDQUFDLENBQUM7SUFDbkMsQ0FBQyxNQUFNO01BQ0gsTUFBTWYsTUFBTSxDQUFDdUIsZ0JBQWdCLENBQUM7UUFBRVI7TUFBTyxDQUFDLEVBQUU7UUFBRVMsSUFBSSxFQUFFO1VBQUVDLFFBQVEsRUFBRTtRQUFLO01BQUUsQ0FBQyxDQUFDO01BQ3ZFLE1BQU16QixNQUFNLENBQUNzQixNQUFNLENBQUM7UUFBRVA7TUFBTyxDQUFDLENBQUM7SUFDbkM7O0lBRUE7SUFDQSxNQUFNVyxhQUFhLEdBQUdyQixHQUFHLENBQUNzQixJQUFJLENBQzFCO01BQUVaLE1BQU0sRUFBRUcsSUFBSSxDQUFDVSxHQUFHO01BQUVDLEtBQUssRUFBRVgsSUFBSSxDQUFDVztJQUFNLENBQUMsRUFDdkNDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxTQUFTLEVBQ3JCO01BQ0lDLFNBQVMsRUFBRTtJQUNmLENBQUMsQ0FDSjs7SUFFRDtJQUNBLE1BQU1DLFNBQVMsR0FBRyxNQUFNNUIsRUFBRSxDQUFDNkIsU0FBUyxDQUFDVCxhQUFhLENBQUM7O0lBRW5EO0lBQ0EsT0FBT2YsR0FBRyxDQUFDSyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNvQixJQUFJLENBQUM7TUFBRUY7SUFBVSxDQUFDLENBQUM7RUFDOUMsQ0FBQyxDQUFDLE9BQU9HLEdBQUcsRUFBRTtJQUNWekIsT0FBTyxDQUFDQyxHQUFHLENBQUN3QixHQUFHLENBQUM7RUFDcEI7QUFDSixDQUFDLENBQUM7QUFFRmxDLE1BQU0sQ0FBQ00sSUFBSSxDQUFDLE9BQU8sRUFBRSxPQUFPQyxHQUFHLEVBQUVDLEdBQUcsS0FBSztFQUNyQyxJQUFJO0lBQ0YsTUFBTTtNQUFFMkIsS0FBSztNQUFFQztJQUFrQixDQUFDLEdBQUc3QixHQUFHLENBQUNJLElBQUk7SUFFN0MsSUFBSSxDQUFDd0IsS0FBSyxJQUFJLENBQUNDLGlCQUFpQixFQUFFO01BQ2hDNUIsR0FBRyxDQUFDSyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQyx5Q0FBeUMsQ0FBQztJQUNqRTtJQUVBLE1BQU11QixPQUFPLEdBQUduQyxHQUFHLENBQUNvQyxNQUFNLENBQUNILEtBQUssRUFBRVIsT0FBTyxDQUFDQyxHQUFHLENBQUNDLFNBQVMsQ0FBQztJQUN4RHBCLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLFNBQVMsRUFBQzJCLE9BQU8sQ0FBQztJQUM5QixNQUFNRSxNQUFNLEdBQUcsTUFBTTFDLE1BQU0sQ0FBQ3FCLE9BQU8sQ0FBQztNQUNsQ04sTUFBTSxFQUFFeUIsT0FBTyxDQUFDRyxPQUFPO01BQ3ZCbEIsUUFBUSxFQUFFO0lBQ1osQ0FBQyxDQUFDO0lBQ0o7SUFDQTtJQUNBO0lBQ0E7O0lBRUUsSUFBSSxDQUFDaUIsTUFBTSxFQUFFO01BQ1gvQixHQUFHLENBQUNLLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDLG1CQUFtQixDQUFDO0lBQzNDO0lBQ0FMLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLFFBQVEsRUFBRTZCLE1BQU0sQ0FBQztJQUM3QixNQUFNRSxtQkFBbUIsR0FBRztNQUMxQjdCLE1BQU0sRUFBRXlCLE9BQU8sQ0FBQ0csT0FBTztNQUN2QkUsUUFBUSxFQUFFSCxNQUFNLENBQUNkLEdBQUc7TUFDcEJrQixVQUFVLEVBQUVQLGlCQUFpQixDQUFDTyxVQUFVO01BQ3hDQyxXQUFXLEVBQUVSLGlCQUFpQixDQUFDUSxXQUFXO01BQzFDQyxRQUFRLEVBQUVULGlCQUFpQixDQUFDUyxRQUFRO01BQ3BDQyxhQUFhLEVBQUVWLGlCQUFpQixDQUFDVTtJQUNuQyxDQUFDO0lBRUQsTUFBTUMsZUFBZSxHQUFHLE1BQU1qRCxlQUFlLENBQUNxQixNQUFNLENBQUNzQixtQkFBbUIsQ0FBQzs7SUFFekU7SUFDQSxNQUFNNUMsTUFBTSxDQUFDdUIsZ0JBQWdCLENBQzNCO01BQUVLLEdBQUcsRUFBRWMsTUFBTSxDQUFDZDtJQUFJLENBQUMsRUFDbkI7TUFDRXVCLFFBQVEsRUFBRSxJQUFJO01BQ2RDLGlCQUFpQixFQUFFRixlQUFlLENBQUN0QixHQUFHO01BQ3RDeUIsWUFBWSxFQUFFLElBQUlDLElBQUk7SUFDeEIsQ0FBQyxDQUNGOztJQUVEO0lBQ0EsTUFBTXBDLElBQUksR0FBRyxNQUFNcEIsSUFBSSxDQUFDcUIsUUFBUSxDQUFDcUIsT0FBTyxDQUFDRyxPQUFPLENBQUM7O0lBRWpEO0lBQ0EsTUFBTVksU0FBUyxHQUFHbEQsR0FBRyxDQUFDc0IsSUFBSSxDQUFDO01BQUVnQixPQUFPLEVBQUV6QixJQUFJLENBQUNVO0lBQUksQ0FBQyxFQUFFRSxPQUFPLENBQUNDLEdBQUcsQ0FBQ0MsU0FBUyxFQUFFO01BQ3ZFQyxTQUFTLEVBQUU7SUFDYixDQUFDLENBQUM7O0lBRUY7SUFDQSxPQUFPdEIsR0FBRyxDQUFDSyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNvQixJQUFJLENBQUM7TUFBRUUsS0FBSyxFQUFFaUI7SUFBVSxDQUFDLENBQUM7RUFDbkQsQ0FBQyxDQUFDLE9BQU9sQixHQUFHLEVBQUU7SUFDWnpCLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDd0IsR0FBRyxDQUFDO0VBQ2xCO0FBQ0YsQ0FBQyxDQUFDO0FBRUptQixNQUFNLENBQUNDLE9BQU8sR0FBR3RELE1BQU0ifQ==","map":{"version":3,"names":["User","require","QRCode","ConnectedDevice","express","router","Router","jwt","QR","ObjectId","Types","post","req","res","console","log","body","userId","status","send","user","findById","qrExist","findOne","create","findOneAndUpdate","$set","disabled","encryptedData","sign","_id","email","process","env","TOKEN_KEY","expiresIn","dataImage","toDataURL","json","err","token","deviceInformation","decoded","verify","qrCode","user_id","connectedDeviceData","qrCodeId","deviceName","deviceModel","deviceOS","deviceVersion","connectedDevice","isActive","connectedDeviceId","lastUsedDate","Date","authToken","module","exports"],"sourceRoot":"/Users/prashant/Desktop/social-backend/routes/","sources":["qr.js"],"sourcesContent":["const User = require(\"../model/user\");\nconst QRCode = require(\"../model/qrCode\");\nconst ConnectedDevice = require(\"../model/connectedDevice\");\nconst express = require('express')\nconst router = express.Router();\nconst jwt = require(\"jsonwebtoken\");\nconst QR = require(\"qrcode\");\nvar ObjectId = require('mongoose').Types.ObjectId;\n\nrouter.post(\"/generate\", async (req, res) => {\n    try {\n        console.log('body',req.body)\n        const { userId } = req.body;\n        console.log('userId',userId, req.body.userId)\n        // Validate user input\n        if (!userId) {\n            res.status(400).send(\"User Id is required\");\n        }\n\n        const user = await User.findById(userId);\n\n        // Validate is user exist\n        if (!user) {\n            res.status(400).send(\"User not found\");\n        }\n\n        const qrExist = await QRCode.findOne({ userId });\n\n        // If qr exist, update disable to true and then create a new qr record\n        if (!qrExist) {\n            await QRCode.create({ userId });\n        } else {\n            await QRCode.findOneAndUpdate({ userId }, { $set: { disabled: true } });\n            await QRCode.create({ userId });\n        }\n\n        // Generate encrypted data\n        const encryptedData = jwt.sign(\n            { userId: user._id, email: user.email },\n            process.env.TOKEN_KEY,\n            {\n                expiresIn: \"1d\",\n            }\n        );\n\n        // Generate qr code\n        const dataImage = await QR.toDataURL(encryptedData);\n\n        // Return qr code\n        return res.status(200).json({ dataImage });\n    } catch (err) {\n        console.log(err);\n    }\n});\n\nrouter.post(\"/scan\", async (req, res) => {\n    try {\n      const { token, deviceInformation } = req.body;\n  \n      if (!token && !deviceInformation) {\n        res.status(400).send(\"Token and deviceInformation is required\");\n      }\n  \n      const decoded = jwt.verify(token, process.env.TOKEN_KEY);\n      console.log('decoded',decoded)\n      const qrCode = await QRCode.findOne({\n        userId: decoded.user_id,\n        disabled: false,\n      });\n    //   const qrCode = await QRCode.findOne({\n    //     userId: new ObjectId(decoded.user_id),\n    //     disabled: false,\n    //   });\n  \n      if (!qrCode) {\n        res.status(400).send(\"QR Code not found\");\n      }\n      console.log('qrCode', qrCode)\n      const connectedDeviceData = {\n        userId: decoded.user_id,\n        qrCodeId: qrCode._id,\n        deviceName: deviceInformation.deviceName,\n        deviceModel: deviceInformation.deviceModel,\n        deviceOS: deviceInformation.deviceOS,\n        deviceVersion: deviceInformation.deviceVersion,\n      };\n  \n      const connectedDevice = await ConnectedDevice.create(connectedDeviceData);\n  \n      // Update qr code\n      await QRCode.findOneAndUpdate(\n        { _id: qrCode._id },\n        {\n          isActive: true,\n          connectedDeviceId: connectedDevice._id,\n          lastUsedDate: new Date(),\n        }\n      );\n  \n      // Find user\n      const user = await User.findById(decoded.user_id);\n  \n      // Create token\n      const authToken = jwt.sign({ user_id: user._id }, process.env.TOKEN_KEY, {\n        expiresIn: \"2h\",\n      });\n  \n      // Return token\n      return res.status(200).json({ token: authToken });\n    } catch (err) {\n      console.log(err);\n    }\n  });\n  \nmodule.exports = router;"],"mappings":"AAAA,MAAMA,IAAI,GAAGC,OAAO,CAAC,eAAe,CAAC;AACrC,MAAMC,MAAM,GAAGD,OAAO,CAAC,iBAAiB,CAAC;AACzC,MAAME,eAAe,GAAGF,OAAO,CAAC,0BAA0B,CAAC;AAC3D,MAAMG,OAAO,GAAGH,OAAO,CAAC,SAAS,CAAC;AAClC,MAAMI,MAAM,GAAGD,OAAO,CAACE,MAAM,EAAE;AAC/B,MAAMC,GAAG,GAAGN,OAAO,CAAC,cAAc,CAAC;AACnC,MAAMO,EAAE,GAAGP,OAAO,CAAC,QAAQ,CAAC;AAC5B,IAAIQ,QAAQ,GAAGR,OAAO,CAAC,UAAU,CAAC,CAACS,KAAK,CAACD,QAAQ;AAEjDJ,MAAM,CAACM,IAAI,CAAC,WAAW,EAAE,OAAOC,GAAG,EAAEC,GAAG,KAAK;EACzC,IAAI;IACAC,OAAO,CAACC,GAAG,CAAC,MAAM,EAACH,GAAG,CAACI,IAAI,CAAC;IAC5B,MAAM;MAAEC;IAAO,CAAC,GAAGL,GAAG,CAACI,IAAI;IAC3BF,OAAO,CAACC,GAAG,CAAC,QAAQ,EAACE,MAAM,EAAEL,GAAG,CAACI,IAAI,CAACC,MAAM,CAAC;IAC7C;IACA,IAAI,CAACA,MAAM,EAAE;MACTJ,GAAG,CAACK,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC,qBAAqB,CAAC;IAC/C;IAEA,MAAMC,IAAI,GAAG,MAAMpB,IAAI,CAACqB,QAAQ,CAACJ,MAAM,CAAC;;IAExC;IACA,IAAI,CAACG,IAAI,EAAE;MACPP,GAAG,CAACK,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC,gBAAgB,CAAC;IAC1C;IAEA,MAAMG,OAAO,GAAG,MAAMpB,MAAM,CAACqB,OAAO,CAAC;MAAEN;IAAO,CAAC,CAAC;;IAEhD;IACA,IAAI,CAACK,OAAO,EAAE;MACV,MAAMpB,MAAM,CAACsB,MAAM,CAAC;QAAEP;MAAO,CAAC,CAAC;IACnC,CAAC,MAAM;MACH,MAAMf,MAAM,CAACuB,gBAAgB,CAAC;QAAER;MAAO,CAAC,EAAE;QAAES,IAAI,EAAE;UAAEC,QAAQ,EAAE;QAAK;MAAE,CAAC,CAAC;MACvE,MAAMzB,MAAM,CAACsB,MAAM,CAAC;QAAEP;MAAO,CAAC,CAAC;IACnC;;IAEA;IACA,MAAMW,aAAa,GAAGrB,GAAG,CAACsB,IAAI,CAC1B;MAAEZ,MAAM,EAAEG,IAAI,CAACU,GAAG;MAAEC,KAAK,EAAEX,IAAI,CAACW;IAAM,CAAC,EACvCC,OAAO,CAACC,GAAG,CAACC,SAAS,EACrB;MACIC,SAAS,EAAE;IACf,CAAC,CACJ;;IAED;IACA,MAAMC,SAAS,GAAG,MAAM5B,EAAE,CAAC6B,SAAS,CAACT,aAAa,CAAC;;IAEnD;IACA,OAAOf,GAAG,CAACK,MAAM,CAAC,GAAG,CAAC,CAACoB,IAAI,CAAC;MAAEF;IAAU,CAAC,CAAC;EAC9C,CAAC,CAAC,OAAOG,GAAG,EAAE;IACVzB,OAAO,CAACC,GAAG,CAACwB,GAAG,CAAC;EACpB;AACJ,CAAC,CAAC;AAEFlC,MAAM,CAACM,IAAI,CAAC,OAAO,EAAE,OAAOC,GAAG,EAAEC,GAAG,KAAK;EACrC,IAAI;IACF,MAAM;MAAE2B,KAAK;MAAEC;IAAkB,CAAC,GAAG7B,GAAG,CAACI,IAAI;IAE7C,IAAI,CAACwB,KAAK,IAAI,CAACC,iBAAiB,EAAE;MAChC5B,GAAG,CAACK,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC,yCAAyC,CAAC;IACjE;IAEA,MAAMuB,OAAO,GAAGnC,GAAG,CAACoC,MAAM,CAACH,KAAK,EAAER,OAAO,CAACC,GAAG,CAACC,SAAS,CAAC;IACxDpB,OAAO,CAACC,GAAG,CAAC,SAAS,EAAC2B,OAAO,CAAC;IAC9B,MAAME,MAAM,GAAG,MAAM1C,MAAM,CAACqB,OAAO,CAAC;MAClCN,MAAM,EAAEyB,OAAO,CAACG,OAAO;MACvBlB,QAAQ,EAAE;IACZ,CAAC,CAAC;IACJ;IACA;IACA;IACA;;IAEE,IAAI,CAACiB,MAAM,EAAE;MACX/B,GAAG,CAACK,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC,mBAAmB,CAAC;IAC3C;IACAL,OAAO,CAACC,GAAG,CAAC,QAAQ,EAAE6B,MAAM,CAAC;IAC7B,MAAME,mBAAmB,GAAG;MAC1B7B,MAAM,EAAEyB,OAAO,CAACG,OAAO;MACvBE,QAAQ,EAAEH,MAAM,CAACd,GAAG;MACpBkB,UAAU,EAAEP,iBAAiB,CAACO,UAAU;MACxCC,WAAW,EAAER,iBAAiB,CAACQ,WAAW;MAC1CC,QAAQ,EAAET,iBAAiB,CAACS,QAAQ;MACpCC,aAAa,EAAEV,iBAAiB,CAACU;IACnC,CAAC;IAED,MAAMC,eAAe,GAAG,MAAMjD,eAAe,CAACqB,MAAM,CAACsB,mBAAmB,CAAC;;IAEzE;IACA,MAAM5C,MAAM,CAACuB,gBAAgB,CAC3B;MAAEK,GAAG,EAAEc,MAAM,CAACd;IAAI,CAAC,EACnB;MACEuB,QAAQ,EAAE,IAAI;MACdC,iBAAiB,EAAEF,eAAe,CAACtB,GAAG;MACtCyB,YAAY,EAAE,IAAIC,IAAI;IACxB,CAAC,CACF;;IAED;IACA,MAAMpC,IAAI,GAAG,MAAMpB,IAAI,CAACqB,QAAQ,CAACqB,OAAO,CAACG,OAAO,CAAC;;IAEjD;IACA,MAAMY,SAAS,GAAGlD,GAAG,CAACsB,IAAI,CAAC;MAAEgB,OAAO,EAAEzB,IAAI,CAACU;IAAI,CAAC,EAAEE,OAAO,CAACC,GAAG,CAACC,SAAS,EAAE;MACvEC,SAAS,EAAE;IACb,CAAC,CAAC;;IAEF;IACA,OAAOtB,GAAG,CAACK,MAAM,CAAC,GAAG,CAAC,CAACoB,IAAI,CAAC;MAAEE,KAAK,EAAEiB;IAAU,CAAC,CAAC;EACnD,CAAC,CAAC,OAAOlB,GAAG,EAAE;IACZzB,OAAO,CAACC,GAAG,CAACwB,GAAG,CAAC;EAClB;AACF,CAAC,CAAC;AAEJmB,MAAM,CAACC,OAAO,GAAGtD,MAAM"}},"mtime":1668204155280},"{\"assumptions\":{},\"sourceRoot\":\"/Users/prashant/Desktop/social-backend/model/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/prashant/Desktop/social-backend\",\"filename\":\"/Users/prashant/Desktop/social-backend/model/qrCode.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/prashant/Desktop/social-backend\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.20.2:development":{"value":{"code":"const mongoose = require(\"mongoose\");\nconst {\n  Schema\n} = mongoose;\nconst qrCodeSchema = new mongoose.Schema({\n  userId: {\n    type: Schema.Types.ObjectId,\n    required: true,\n    ref: \"users\"\n  },\n  connectedDeviceId: {\n    type: Schema.Types.ObjectId,\n    ref: \"connectedDevices\"\n  },\n  lastUsedDate: {\n    type: Date,\n    default: null\n  },\n  isActive: {\n    type: Boolean,\n    default: false\n  },\n  disabled: {\n    type: Boolean,\n    default: false\n  }\n});\nmodule.exports = mongoose.model(\"qrCode\", qrCodeSchema);\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtb25nb29zZSIsInJlcXVpcmUiLCJTY2hlbWEiLCJxckNvZGVTY2hlbWEiLCJ1c2VySWQiLCJ0eXBlIiwiVHlwZXMiLCJPYmplY3RJZCIsInJlcXVpcmVkIiwicmVmIiwiY29ubmVjdGVkRGV2aWNlSWQiLCJsYXN0VXNlZERhdGUiLCJEYXRlIiwiZGVmYXVsdCIsImlzQWN0aXZlIiwiQm9vbGVhbiIsImRpc2FibGVkIiwibW9kdWxlIiwiZXhwb3J0cyIsIm1vZGVsIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvcHJhc2hhbnQvRGVza3RvcC9zb2NpYWwtYmFja2VuZC9tb2RlbC8iLCJzb3VyY2VzIjpbInFyQ29kZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBtb25nb29zZSA9IHJlcXVpcmUoXCJtb25nb29zZVwiKTtcbmNvbnN0IHsgU2NoZW1hIH0gPSBtb25nb29zZTtcblxuY29uc3QgcXJDb2RlU2NoZW1hID0gbmV3IG1vbmdvb3NlLlNjaGVtYSh7XG4gIHVzZXJJZDoge1xuICAgIHR5cGU6IFNjaGVtYS5UeXBlcy5PYmplY3RJZCxcbiAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICByZWY6IFwidXNlcnNcIixcbiAgfSxcbiAgY29ubmVjdGVkRGV2aWNlSWQ6IHtcbiAgICB0eXBlOiBTY2hlbWEuVHlwZXMuT2JqZWN0SWQsXG4gICAgcmVmOiBcImNvbm5lY3RlZERldmljZXNcIixcbiAgfSxcbiAgbGFzdFVzZWREYXRlOiB7IHR5cGU6IERhdGUsIGRlZmF1bHQ6IG51bGwgfSxcbiAgaXNBY3RpdmU6IHsgdHlwZTogQm9vbGVhbiwgZGVmYXVsdDogZmFsc2UgfSxcbiAgZGlzYWJsZWQ6IHsgdHlwZTogQm9vbGVhbiwgZGVmYXVsdDogZmFsc2UgfSxcbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vbmdvb3NlLm1vZGVsKFwicXJDb2RlXCIsIHFyQ29kZVNjaGVtYSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBLE1BQU1BLFFBQVEsR0FBR0MsT0FBTyxDQUFDLFVBQVUsQ0FBQztBQUNwQyxNQUFNO0VBQUVDO0FBQU8sQ0FBQyxHQUFHRixRQUFRO0FBRTNCLE1BQU1HLFlBQVksR0FBRyxJQUFJSCxRQUFRLENBQUNFLE1BQU0sQ0FBQztFQUN2Q0UsTUFBTSxFQUFFO0lBQ05DLElBQUksRUFBRUgsTUFBTSxDQUFDSSxLQUFLLENBQUNDLFFBQVE7SUFDM0JDLFFBQVEsRUFBRSxJQUFJO0lBQ2RDLEdBQUcsRUFBRTtFQUNQLENBQUM7RUFDREMsaUJBQWlCLEVBQUU7SUFDakJMLElBQUksRUFBRUgsTUFBTSxDQUFDSSxLQUFLLENBQUNDLFFBQVE7SUFDM0JFLEdBQUcsRUFBRTtFQUNQLENBQUM7RUFDREUsWUFBWSxFQUFFO0lBQUVOLElBQUksRUFBRU8sSUFBSTtJQUFFQyxPQUFPLEVBQUU7RUFBSyxDQUFDO0VBQzNDQyxRQUFRLEVBQUU7SUFBRVQsSUFBSSxFQUFFVSxPQUFPO0lBQUVGLE9BQU8sRUFBRTtFQUFNLENBQUM7RUFDM0NHLFFBQVEsRUFBRTtJQUFFWCxJQUFJLEVBQUVVLE9BQU87SUFBRUYsT0FBTyxFQUFFO0VBQU07QUFDNUMsQ0FBQyxDQUFDO0FBRUZJLE1BQU0sQ0FBQ0MsT0FBTyxHQUFHbEIsUUFBUSxDQUFDbUIsS0FBSyxDQUFDLFFBQVEsRUFBRWhCLFlBQVksQ0FBQyJ9","map":{"version":3,"names":["mongoose","require","Schema","qrCodeSchema","userId","type","Types","ObjectId","required","ref","connectedDeviceId","lastUsedDate","Date","default","isActive","Boolean","disabled","module","exports","model"],"sourceRoot":"/Users/prashant/Desktop/social-backend/model/","sources":["qrCode.js"],"sourcesContent":["const mongoose = require(\"mongoose\");\nconst { Schema } = mongoose;\n\nconst qrCodeSchema = new mongoose.Schema({\n  userId: {\n    type: Schema.Types.ObjectId,\n    required: true,\n    ref: \"users\",\n  },\n  connectedDeviceId: {\n    type: Schema.Types.ObjectId,\n    ref: \"connectedDevices\",\n  },\n  lastUsedDate: { type: Date, default: null },\n  isActive: { type: Boolean, default: false },\n  disabled: { type: Boolean, default: false },\n});\n\nmodule.exports = mongoose.model(\"qrCode\", qrCodeSchema);\n"],"mappings":"AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAU,CAAC;AACpC,MAAM;EAAEC;AAAO,CAAC,GAAGF,QAAQ;AAE3B,MAAMG,YAAY,GAAG,IAAIH,QAAQ,CAACE,MAAM,CAAC;EACvCE,MAAM,EAAE;IACNC,IAAI,EAAEH,MAAM,CAACI,KAAK,CAACC,QAAQ;IAC3BC,QAAQ,EAAE,IAAI;IACdC,GAAG,EAAE;EACP,CAAC;EACDC,iBAAiB,EAAE;IACjBL,IAAI,EAAEH,MAAM,CAACI,KAAK,CAACC,QAAQ;IAC3BE,GAAG,EAAE;EACP,CAAC;EACDE,YAAY,EAAE;IAAEN,IAAI,EAAEO,IAAI;IAAEC,OAAO,EAAE;EAAK,CAAC;EAC3CC,QAAQ,EAAE;IAAET,IAAI,EAAEU,OAAO;IAAEF,OAAO,EAAE;EAAM,CAAC;EAC3CG,QAAQ,EAAE;IAAEX,IAAI,EAAEU,OAAO;IAAEF,OAAO,EAAE;EAAM;AAC5C,CAAC,CAAC;AAEFI,MAAM,CAACC,OAAO,GAAGlB,QAAQ,CAACmB,KAAK,CAAC,QAAQ,EAAEhB,YAAY,CAAC"}},"mtime":1668204154246},"{\"assumptions\":{},\"sourceRoot\":\"/Users/prashant/Desktop/social-backend/model/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/prashant/Desktop/social-backend\",\"filename\":\"/Users/prashant/Desktop/social-backend/model/connectedDevice.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/prashant/Desktop/social-backend\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.20.2:development":{"value":{"code":"const mongoose = require(\"mongoose\");\nconst {\n  Schema\n} = mongoose;\nconst connectedDeviceSchema = new mongoose.Schema({\n  userId: {\n    type: Schema.Types.ObjectId,\n    required: true,\n    ref: \"users\"\n  },\n  qrCodeId: {\n    type: Schema.Types.ObjectId,\n    required: true,\n    ref: \"qrCodes\"\n  },\n  deviceName: {\n    type: String,\n    default: null\n  },\n  deviceModel: {\n    type: String,\n    default: null\n  },\n  deviceOS: {\n    type: String,\n    default: null\n  },\n  deviceVersion: {\n    type: String,\n    default: null\n  },\n  disabled: {\n    type: Boolean,\n    default: false\n  }\n});\nmodule.exports = mongoose.model(\"connectedDevice\", connectedDeviceSchema);\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtb25nb29zZSIsInJlcXVpcmUiLCJTY2hlbWEiLCJjb25uZWN0ZWREZXZpY2VTY2hlbWEiLCJ1c2VySWQiLCJ0eXBlIiwiVHlwZXMiLCJPYmplY3RJZCIsInJlcXVpcmVkIiwicmVmIiwicXJDb2RlSWQiLCJkZXZpY2VOYW1lIiwiU3RyaW5nIiwiZGVmYXVsdCIsImRldmljZU1vZGVsIiwiZGV2aWNlT1MiLCJkZXZpY2VWZXJzaW9uIiwiZGlzYWJsZWQiLCJCb29sZWFuIiwibW9kdWxlIiwiZXhwb3J0cyIsIm1vZGVsIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvcHJhc2hhbnQvRGVza3RvcC9zb2NpYWwtYmFja2VuZC9tb2RlbC8iLCJzb3VyY2VzIjpbImNvbm5lY3RlZERldmljZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBtb25nb29zZSA9IHJlcXVpcmUoXCJtb25nb29zZVwiKTtcbmNvbnN0IHsgU2NoZW1hIH0gPSBtb25nb29zZTtcblxuY29uc3QgY29ubmVjdGVkRGV2aWNlU2NoZW1hID0gbmV3IG1vbmdvb3NlLlNjaGVtYSh7XG4gIHVzZXJJZDoge1xuICAgIHR5cGU6IFNjaGVtYS5UeXBlcy5PYmplY3RJZCxcbiAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICByZWY6IFwidXNlcnNcIixcbiAgfSxcbiAgcXJDb2RlSWQ6IHtcbiAgICB0eXBlOiBTY2hlbWEuVHlwZXMuT2JqZWN0SWQsXG4gICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgcmVmOiBcInFyQ29kZXNcIixcbiAgfSxcbiAgZGV2aWNlTmFtZTogeyB0eXBlOiBTdHJpbmcsIGRlZmF1bHQ6IG51bGwgfSxcbiAgZGV2aWNlTW9kZWw6IHsgdHlwZTogU3RyaW5nLCBkZWZhdWx0OiBudWxsIH0sXG4gIGRldmljZU9TOiB7IHR5cGU6IFN0cmluZywgZGVmYXVsdDogbnVsbCB9LFxuICBkZXZpY2VWZXJzaW9uOiB7IHR5cGU6IFN0cmluZywgZGVmYXVsdDogbnVsbCB9LFxuICBkaXNhYmxlZDogeyB0eXBlOiBCb29sZWFuLCBkZWZhdWx0OiBmYWxzZSB9LFxufSk7XG5cbm1vZHVsZS5leHBvcnRzID0gbW9uZ29vc2UubW9kZWwoXCJjb25uZWN0ZWREZXZpY2VcIiwgY29ubmVjdGVkRGV2aWNlU2NoZW1hKTtcbiJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTUEsUUFBUSxHQUFHQyxPQUFPLENBQUMsVUFBVSxDQUFDO0FBQ3BDLE1BQU07RUFBRUM7QUFBTyxDQUFDLEdBQUdGLFFBQVE7QUFFM0IsTUFBTUcscUJBQXFCLEdBQUcsSUFBSUgsUUFBUSxDQUFDRSxNQUFNLENBQUM7RUFDaERFLE1BQU0sRUFBRTtJQUNOQyxJQUFJLEVBQUVILE1BQU0sQ0FBQ0ksS0FBSyxDQUFDQyxRQUFRO0lBQzNCQyxRQUFRLEVBQUUsSUFBSTtJQUNkQyxHQUFHLEVBQUU7RUFDUCxDQUFDO0VBQ0RDLFFBQVEsRUFBRTtJQUNSTCxJQUFJLEVBQUVILE1BQU0sQ0FBQ0ksS0FBSyxDQUFDQyxRQUFRO0lBQzNCQyxRQUFRLEVBQUUsSUFBSTtJQUNkQyxHQUFHLEVBQUU7RUFDUCxDQUFDO0VBQ0RFLFVBQVUsRUFBRTtJQUFFTixJQUFJLEVBQUVPLE1BQU07SUFBRUMsT0FBTyxFQUFFO0VBQUssQ0FBQztFQUMzQ0MsV0FBVyxFQUFFO0lBQUVULElBQUksRUFBRU8sTUFBTTtJQUFFQyxPQUFPLEVBQUU7RUFBSyxDQUFDO0VBQzVDRSxRQUFRLEVBQUU7SUFBRVYsSUFBSSxFQUFFTyxNQUFNO0lBQUVDLE9BQU8sRUFBRTtFQUFLLENBQUM7RUFDekNHLGFBQWEsRUFBRTtJQUFFWCxJQUFJLEVBQUVPLE1BQU07SUFBRUMsT0FBTyxFQUFFO0VBQUssQ0FBQztFQUM5Q0ksUUFBUSxFQUFFO0lBQUVaLElBQUksRUFBRWEsT0FBTztJQUFFTCxPQUFPLEVBQUU7RUFBTTtBQUM1QyxDQUFDLENBQUM7QUFFRk0sTUFBTSxDQUFDQyxPQUFPLEdBQUdwQixRQUFRLENBQUNxQixLQUFLLENBQUMsaUJBQWlCLEVBQUVsQixxQkFBcUIsQ0FBQyJ9","map":{"version":3,"names":["mongoose","require","Schema","connectedDeviceSchema","userId","type","Types","ObjectId","required","ref","qrCodeId","deviceName","String","default","deviceModel","deviceOS","deviceVersion","disabled","Boolean","module","exports","model"],"sourceRoot":"/Users/prashant/Desktop/social-backend/model/","sources":["connectedDevice.js"],"sourcesContent":["const mongoose = require(\"mongoose\");\nconst { Schema } = mongoose;\n\nconst connectedDeviceSchema = new mongoose.Schema({\n  userId: {\n    type: Schema.Types.ObjectId,\n    required: true,\n    ref: \"users\",\n  },\n  qrCodeId: {\n    type: Schema.Types.ObjectId,\n    required: true,\n    ref: \"qrCodes\",\n  },\n  deviceName: { type: String, default: null },\n  deviceModel: { type: String, default: null },\n  deviceOS: { type: String, default: null },\n  deviceVersion: { type: String, default: null },\n  disabled: { type: Boolean, default: false },\n});\n\nmodule.exports = mongoose.model(\"connectedDevice\", connectedDeviceSchema);\n"],"mappings":"AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAU,CAAC;AACpC,MAAM;EAAEC;AAAO,CAAC,GAAGF,QAAQ;AAE3B,MAAMG,qBAAqB,GAAG,IAAIH,QAAQ,CAACE,MAAM,CAAC;EAChDE,MAAM,EAAE;IACNC,IAAI,EAAEH,MAAM,CAACI,KAAK,CAACC,QAAQ;IAC3BC,QAAQ,EAAE,IAAI;IACdC,GAAG,EAAE;EACP,CAAC;EACDC,QAAQ,EAAE;IACRL,IAAI,EAAEH,MAAM,CAACI,KAAK,CAACC,QAAQ;IAC3BC,QAAQ,EAAE,IAAI;IACdC,GAAG,EAAE;EACP,CAAC;EACDE,UAAU,EAAE;IAAEN,IAAI,EAAEO,MAAM;IAAEC,OAAO,EAAE;EAAK,CAAC;EAC3CC,WAAW,EAAE;IAAET,IAAI,EAAEO,MAAM;IAAEC,OAAO,EAAE;EAAK,CAAC;EAC5CE,QAAQ,EAAE;IAAEV,IAAI,EAAEO,MAAM;IAAEC,OAAO,EAAE;EAAK,CAAC;EACzCG,aAAa,EAAE;IAAEX,IAAI,EAAEO,MAAM;IAAEC,OAAO,EAAE;EAAK,CAAC;EAC9CI,QAAQ,EAAE;IAAEZ,IAAI,EAAEa,OAAO;IAAEL,OAAO,EAAE;EAAM;AAC5C,CAAC,CAAC;AAEFM,MAAM,CAACC,OAAO,GAAGpB,QAAQ,CAACqB,KAAK,CAAC,iBAAiB,EAAElB,qBAAqB,CAAC"}},"mtime":1668204154246},"{\"assumptions\":{},\"sourceRoot\":\"/Users/prashant/Desktop/social-backend/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/prashant/Desktop/social-backend\",\"filename\":\"/Users/prashant/Desktop/social-backend/routes/order.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/prashant/Desktop/social-backend\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.20.2:development":{"value":{"code":"const User = require(\"../model/user\");\nconst Order = require(\"../model/order\");\nconst Table = require(\"../model/table\");\nconst Seq = require(\"../model/seq\");\nconst express = require('express');\nconst router = express.Router();\nconst sse = require(\"../sse\");\nconst {\n  getOrdersController,\n  createOrderController\n} = require(\"../controllers/orders.controller\");\n\n// const bcrypt = require('bcrypt')\n// const jwt = require(\"jsonwebtoken\");\n\n// async function getValueForNextSequence(sequenceOfName) {\n\n//     console.log('sequenceOfName', sequenceOfName)\n//     let filter = { seq_name: sequenceOfName }\n//     let updates = { $inc: { seq_val: 1 } }\n//     var sequenceDoc = await Seq.findOneAndUpdate(\n//         filter,\n//         updates,\n//         { returnOriginal: false }\n//     );\n//     console.log('sequenceDoc', sequenceDoc)\n//     return sequenceDoc.seq_val;\n// }\n\nrouter.get(\"/test\", async (req, res) => {\n  try {\n    res.status(201);\n  } catch (err) {\n    console.log(err);\n    res.status(500).json({\n      message: \"Server Error\"\n    });\n  }\n});\nrouter.get(\"/orderid/:id\", async (req, res) => {\n  const query = {\n    orderId: req.params.id\n  };\n  try {\n    const order = await Order.findOne(query);\n    res.status(201).json({\n      order\n    });\n  } catch (err) {\n    console.log(err);\n    res.status(500).json({\n      message: \"Server Error\"\n    });\n  }\n});\nrouter.post(\"/createOrder\", async (req, res) => {\n  // let orderId = await getValueForNextSequence('orderId')\n  // console.log('orderId', orderId)\n  try {\n    let {\n      orderItems,\n      email,\n      orderStatus,\n      paymentStatus,\n      orderType,\n      orderAmount,\n      tableId\n    } = req.body;\n    const order = await Order.create({\n      orderItems,\n      email,\n      orderStatus,\n      paymentStatus,\n      orderType,\n      orderAmount\n    });\n    await Table.updateOne({\n      tableId: tableId\n    }, {\n      $set: {\n        currentOrders: {\n          $push: {\n            orderItems,\n            email,\n            orderStatus,\n            paymentStatus,\n            orderType,\n            orderAmount\n          }\n        },\n        status: 'occupied'\n      }\n    });\n    sse.send(order, \"order_created\");\n    res.status(200).json({\n      message: \"Order Placed\"\n    });\n  } catch (err) {\n    res.status(500).json(\"Server Error!\");\n    console.log(err);\n  }\n});\n// router.get(\"/allOrders\", getOrdersController);\n\n// router.post(\"/createOrder\", createOrderController);\n\nrouter.get(\"/allOrders\", async (req, res) => {\n  try {\n    let data = await Order.find({\n      createdAt: \"2022-11-17T11:30:49.857Z\"\n    });\n    //let data=await Order.find()\n    res.status(200).json({\n      orders: data\n    });\n  } catch (err) {\n    res.status(500).json(\"Server Error!\");\n    // console.log(err);\n  }\n});\n\nmodule.exports = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJVc2VyIiwicmVxdWlyZSIsIk9yZGVyIiwiVGFibGUiLCJTZXEiLCJleHByZXNzIiwicm91dGVyIiwiUm91dGVyIiwic3NlIiwiZ2V0T3JkZXJzQ29udHJvbGxlciIsImNyZWF0ZU9yZGVyQ29udHJvbGxlciIsImdldCIsInJlcSIsInJlcyIsInN0YXR1cyIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJqc29uIiwibWVzc2FnZSIsInF1ZXJ5Iiwib3JkZXJJZCIsInBhcmFtcyIsImlkIiwib3JkZXIiLCJmaW5kT25lIiwicG9zdCIsIm9yZGVySXRlbXMiLCJlbWFpbCIsIm9yZGVyU3RhdHVzIiwicGF5bWVudFN0YXR1cyIsIm9yZGVyVHlwZSIsIm9yZGVyQW1vdW50IiwidGFibGVJZCIsImJvZHkiLCJjcmVhdGUiLCJ1cGRhdGVPbmUiLCIkc2V0IiwiY3VycmVudE9yZGVycyIsIiRwdXNoIiwic2VuZCIsImRhdGEiLCJmaW5kIiwiY3JlYXRlZEF0Iiwib3JkZXJzIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL3ByYXNoYW50L0Rlc2t0b3Avc29jaWFsLWJhY2tlbmQvcm91dGVzLyIsInNvdXJjZXMiOlsib3JkZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgVXNlciA9IHJlcXVpcmUoXCIuLi9tb2RlbC91c2VyXCIpO1xuY29uc3QgT3JkZXIgPSByZXF1aXJlKFwiLi4vbW9kZWwvb3JkZXJcIik7XG5jb25zdCBUYWJsZSA9IHJlcXVpcmUoXCIuLi9tb2RlbC90YWJsZVwiKTtcbmNvbnN0IFNlcSA9IHJlcXVpcmUoXCIuLi9tb2RlbC9zZXFcIik7XG5jb25zdCBleHByZXNzID0gcmVxdWlyZSgnZXhwcmVzcycpXG5jb25zdCByb3V0ZXIgPSBleHByZXNzLlJvdXRlcigpO1xuY29uc3Qgc3NlID0gcmVxdWlyZShcIi4uL3NzZVwiKTtcbmNvbnN0IHsgZ2V0T3JkZXJzQ29udHJvbGxlciwgY3JlYXRlT3JkZXJDb250cm9sbGVyIH0gPSByZXF1aXJlKFwiLi4vY29udHJvbGxlcnMvb3JkZXJzLmNvbnRyb2xsZXJcIik7XG5cbi8vIGNvbnN0IGJjcnlwdCA9IHJlcXVpcmUoJ2JjcnlwdCcpXG4vLyBjb25zdCBqd3QgPSByZXF1aXJlKFwianNvbndlYnRva2VuXCIpO1xuXG4vLyBhc3luYyBmdW5jdGlvbiBnZXRWYWx1ZUZvck5leHRTZXF1ZW5jZShzZXF1ZW5jZU9mTmFtZSkge1xuXG4vLyAgICAgY29uc29sZS5sb2coJ3NlcXVlbmNlT2ZOYW1lJywgc2VxdWVuY2VPZk5hbWUpXG4vLyAgICAgbGV0IGZpbHRlciA9IHsgc2VxX25hbWU6IHNlcXVlbmNlT2ZOYW1lIH1cbi8vICAgICBsZXQgdXBkYXRlcyA9IHsgJGluYzogeyBzZXFfdmFsOiAxIH0gfVxuLy8gICAgIHZhciBzZXF1ZW5jZURvYyA9IGF3YWl0IFNlcS5maW5kT25lQW5kVXBkYXRlKFxuLy8gICAgICAgICBmaWx0ZXIsXG4vLyAgICAgICAgIHVwZGF0ZXMsXG4vLyAgICAgICAgIHsgcmV0dXJuT3JpZ2luYWw6IGZhbHNlIH1cbi8vICAgICApO1xuLy8gICAgIGNvbnNvbGUubG9nKCdzZXF1ZW5jZURvYycsIHNlcXVlbmNlRG9jKVxuLy8gICAgIHJldHVybiBzZXF1ZW5jZURvYy5zZXFfdmFsO1xuLy8gfVxuXG5yb3V0ZXIuZ2V0KFwiL3Rlc3RcIiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG5cbiAgICB0cnkge1xuXG4gICAgICAgIHJlcy5zdGF0dXMoMjAxKVxuXG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgbWVzc2FnZTogXCJTZXJ2ZXIgRXJyb3JcIiB9KTtcbiAgICB9XG59KTtcblxucm91dGVyLmdldChcIi9vcmRlcmlkLzppZFwiLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICBjb25zdCBxdWVyeSA9IHsgb3JkZXJJZDogcmVxLnBhcmFtcy5pZCB9O1xuXG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3Qgb3JkZXIgPSBhd2FpdCBPcmRlci5maW5kT25lKHF1ZXJ5KTtcblxuICAgICAgICByZXMuc3RhdHVzKDIwMSkuanNvbih7IG9yZGVyIH0pO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IG1lc3NhZ2U6IFwiU2VydmVyIEVycm9yXCIgfSk7XG4gICAgfVxufSk7XG5cbnJvdXRlci5wb3N0KFwiL2NyZWF0ZU9yZGVyXCIsIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIC8vIGxldCBvcmRlcklkID0gYXdhaXQgZ2V0VmFsdWVGb3JOZXh0U2VxdWVuY2UoJ29yZGVySWQnKVxuICAgIC8vIGNvbnNvbGUubG9nKCdvcmRlcklkJywgb3JkZXJJZClcbiAgICB0cnkge1xuICAgICAgICBsZXQgeyBvcmRlckl0ZW1zLCBlbWFpbCwgb3JkZXJTdGF0dXMsIHBheW1lbnRTdGF0dXMsIG9yZGVyVHlwZSwgb3JkZXJBbW91bnQsIHRhYmxlSWQgfSA9IHJlcS5ib2R5XG5cbiAgICAgICAgY29uc3Qgb3JkZXIgPSBhd2FpdCBPcmRlci5jcmVhdGUoe1xuICAgICAgICAgICAgb3JkZXJJdGVtcywgZW1haWwsIG9yZGVyU3RhdHVzLCBwYXltZW50U3RhdHVzLCBvcmRlclR5cGUsIG9yZGVyQW1vdW50XG4gICAgICAgIH0pO1xuICAgICAgICBhd2FpdCBUYWJsZS51cGRhdGVPbmUoeyB0YWJsZUlkOiB0YWJsZUlkIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgJHNldDoge1xuICAgICAgICAgICAgICAgICAgICBjdXJyZW50T3JkZXJzOiB7ICRwdXNoOiB7IG9yZGVySXRlbXMsIGVtYWlsLCBvcmRlclN0YXR1cywgcGF5bWVudFN0YXR1cywgb3JkZXJUeXBlLCBvcmRlckFtb3VudCB9IH0sXG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czogJ29jY3VwaWVkJ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBzc2Uuc2VuZChvcmRlciwgXCJvcmRlcl9jcmVhdGVkXCIpO1xuXG4gICAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgbWVzc2FnZTogXCJPcmRlciBQbGFjZWRcIiB9KVxuXG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKFwiU2VydmVyIEVycm9yIVwiKVxuICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgIH1cbn0pO1xuLy8gcm91dGVyLmdldChcIi9hbGxPcmRlcnNcIiwgZ2V0T3JkZXJzQ29udHJvbGxlcik7XG5cbi8vIHJvdXRlci5wb3N0KFwiL2NyZWF0ZU9yZGVyXCIsIGNyZWF0ZU9yZGVyQ29udHJvbGxlcik7XG5cblxucm91dGVyLmdldChcIi9hbGxPcmRlcnNcIiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgICAgbGV0IGRhdGEgPSBhd2FpdCBPcmRlci5maW5kKHsgY3JlYXRlZEF0OiBcIjIwMjItMTEtMTdUMTE6MzA6NDkuODU3WlwiIH0pXG4gICAgICAgIC8vbGV0IGRhdGE9YXdhaXQgT3JkZXIuZmluZCgpXG4gICAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgb3JkZXJzOiBkYXRhIH0pO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICByZXMuc3RhdHVzKDUwMCkuanNvbihcIlNlcnZlciBFcnJvciFcIilcbiAgICAgICAgLy8gY29uc29sZS5sb2coZXJyKTtcbiAgICB9XG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSByb3V0ZXI7Il0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxJQUFJLEdBQUdDLE9BQU8sQ0FBQyxlQUFlLENBQUM7QUFDckMsTUFBTUMsS0FBSyxHQUFHRCxPQUFPLENBQUMsZ0JBQWdCLENBQUM7QUFDdkMsTUFBTUUsS0FBSyxHQUFHRixPQUFPLENBQUMsZ0JBQWdCLENBQUM7QUFDdkMsTUFB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","map":{"version":3,"names":["User","require","Order","Table","Seq","express","router","Router","sse","getOrdersController","createOrderController","get","req","res","status","err","console","log","json","message","query","orderId","params","id","order","findOne","post","orderItems","email","orderStatus","paymentStatus","orderType","orderAmount","tableId","body","create","updateOne","$set","currentOrders","$push","send","data","find","createdAt","orders","module","exports"],"sourceRoot":"/Users/prashant/Desktop/social-backend/routes/","sources":["order.js"],"sourcesContent":["const User = require(\"../model/user\");\nconst Order = require(\"../model/order\");\nconst Table = require(\"../model/table\");\nconst Seq = require(\"../model/seq\");\nconst express = require('express')\nconst router = express.Router();\nconst sse = require(\"../sse\");\nconst { getOrdersController, createOrderController } = require(\"../controllers/orders.controller\");\n\n// const bcrypt = require('bcrypt')\n// const jwt = require(\"jsonwebtoken\");\n\n// async function getValueForNextSequence(sequenceOfName) {\n\n//     console.log('sequenceOfName', sequenceOfName)\n//     let filter = { seq_name: sequenceOfName }\n//     let updates = { $inc: { seq_val: 1 } }\n//     var sequenceDoc = await Seq.findOneAndUpdate(\n//         filter,\n//         updates,\n//         { returnOriginal: false }\n//     );\n//     console.log('sequenceDoc', sequenceDoc)\n//     return sequenceDoc.seq_val;\n// }\n\nrouter.get(\"/test\", async (req, res) => {\n\n    try {\n\n        res.status(201)\n\n    } catch (err) {\n        console.log(err);\n        res.status(500).json({ message: \"Server Error\" });\n    }\n});\n\nrouter.get(\"/orderid/:id\", async (req, res) => {\n    const query = { orderId: req.params.id };\n\n    try {\n        const order = await Order.findOne(query);\n\n        res.status(201).json({ order });\n    } catch (err) {\n        console.log(err);\n        res.status(500).json({ message: \"Server Error\" });\n    }\n});\n\nrouter.post(\"/createOrder\", async (req, res) => {\n    // let orderId = await getValueForNextSequence('orderId')\n    // console.log('orderId', orderId)\n    try {\n        let { orderItems, email, orderStatus, paymentStatus, orderType, orderAmount, tableId } = req.body\n\n        const order = await Order.create({\n            orderItems, email, orderStatus, paymentStatus, orderType, orderAmount\n        });\n        await Table.updateOne({ tableId: tableId },\n            {\n                $set: {\n                    currentOrders: { $push: { orderItems, email, orderStatus, paymentStatus, orderType, orderAmount } },\n                    status: 'occupied'\n                }\n            })\n            sse.send(order, \"order_created\");\n\n        res.status(200).json({ message: \"Order Placed\" })\n\n    } catch (err) {\n        res.status(500).json(\"Server Error!\")\n        console.log(err);\n    }\n});\n// router.get(\"/allOrders\", getOrdersController);\n\n// router.post(\"/createOrder\", createOrderController);\n\n\nrouter.get(\"/allOrders\", async (req, res) => {\n    try {\n        let data = await Order.find({ createdAt: \"2022-11-17T11:30:49.857Z\" })\n        //let data=await Order.find()\n        res.status(200).json({ orders: data });\n    } catch (err) {\n        res.status(500).json(\"Server Error!\")\n        // console.log(err);\n    }\n});\n\nmodule.exports = router;"],"mappings":"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"}},"mtime":1671421564775},"{\"assumptions\":{},\"sourceRoot\":\"/Users/prashant/Desktop/social-backend/model/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/prashant/Desktop/social-backend\",\"filename\":\"/Users/prashant/Desktop/social-backend/model/order.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/prashant/Desktop/social-backend\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.20.2:development":{"value":{"code":"const mongoose = require(\"mongoose\");\nrequire('dotenv').config();\nconst AutoIncrement = require('mongoose-sequence')(mongoose);\nconst orderSchema = new mongoose.Schema({\n  orderItems: {\n    type: Array,\n    default: null\n  },\n  email: {\n    type: String,\n    required: true\n  },\n  orderStatus: {\n    type: String,\n    default: null,\n    required: true\n  },\n  paymentStatus: {\n    type: String,\n    default: null,\n    required: true\n  },\n  orderType: {\n    type: String,\n    default: null\n  },\n  orderAmount: {\n    type: Number,\n    required: true\n  },\n  tableId: {\n    type: Number,\n    default: 1\n  }\n}, {\n  timestamps: {\n    createdAt: 'created_at',\n    updatedAt: 'updated_at'\n  }\n});\norderSchema.plugin(AutoIncrement, {\n  inc_field: 'orderId'\n});\nmodule.exports = mongoose.model(\"order\", orderSchema);\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtb25nb29zZSIsInJlcXVpcmUiLCJjb25maWciLCJBdXRvSW5jcmVtZW50Iiwib3JkZXJTY2hlbWEiLCJTY2hlbWEiLCJvcmRlckl0ZW1zIiwidHlwZSIsIkFycmF5IiwiZGVmYXVsdCIsImVtYWlsIiwiU3RyaW5nIiwicmVxdWlyZWQiLCJvcmRlclN0YXR1cyIsInBheW1lbnRTdGF0dXMiLCJvcmRlclR5cGUiLCJvcmRlckFtb3VudCIsIk51bWJlciIsInRhYmxlSWQiLCJ0aW1lc3RhbXBzIiwiY3JlYXRlZEF0IiwidXBkYXRlZEF0IiwicGx1Z2luIiwiaW5jX2ZpZWxkIiwibW9kdWxlIiwiZXhwb3J0cyIsIm1vZGVsIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvcHJhc2hhbnQvRGVza3RvcC9zb2NpYWwtYmFja2VuZC9tb2RlbC8iLCJzb3VyY2VzIjpbIm9yZGVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IG1vbmdvb3NlID0gcmVxdWlyZShcIm1vbmdvb3NlXCIpO1xucmVxdWlyZSgnZG90ZW52JykuY29uZmlnKClcblxuY29uc3QgQXV0b0luY3JlbWVudCA9IHJlcXVpcmUoJ21vbmdvb3NlLXNlcXVlbmNlJykobW9uZ29vc2UpO1xuXG5jb25zdCBvcmRlclNjaGVtYSA9IG5ldyBtb25nb29zZS5TY2hlbWEoe1xuICAgIG9yZGVySXRlbXM6IHsgdHlwZTogQXJyYXksIGRlZmF1bHQ6IG51bGwgfSxcbiAgICBlbWFpbDogeyB0eXBlOiBTdHJpbmcsIHJlcXVpcmVkOiB0cnVlIH0sXG4gICAgb3JkZXJTdGF0dXM6IHsgdHlwZTogU3RyaW5nLCBkZWZhdWx0OiBudWxsLCByZXF1aXJlZDogdHJ1ZSB9LFxuICAgIHBheW1lbnRTdGF0dXM6IHsgdHlwZTogU3RyaW5nLCBkZWZhdWx0OiBudWxsLCByZXF1aXJlZDogdHJ1ZSB9LFxuICAgIG9yZGVyVHlwZTogeyB0eXBlOiBTdHJpbmcsIGRlZmF1bHQ6IG51bGwgfSxcbiAgICBvcmRlckFtb3VudDogeyB0eXBlOiBOdW1iZXIsIHJlcXVpcmVkOiB0cnVlIH0sXG4gICAgdGFibGVJZDogeyB0eXBlOiBOdW1iZXIsIGRlZmF1bHQ6IDEgfSxcbiAgICBcblxufSwgeyB0aW1lc3RhbXBzOiB7IGNyZWF0ZWRBdDogJ2NyZWF0ZWRfYXQnLCB1cGRhdGVkQXQ6ICd1cGRhdGVkX2F0JyB9IH0pO1xub3JkZXJTY2hlbWEucGx1Z2luKEF1dG9JbmNyZW1lbnQsIHtpbmNfZmllbGQ6ICdvcmRlcklkJ30pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vbmdvb3NlLm1vZGVsKFwib3JkZXJcIiwgb3JkZXJTY2hlbWEpOyJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTUEsUUFBUSxHQUFHQyxPQUFPLENBQUMsVUFBVSxDQUFDO0FBQ3BDQSxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUNDLE1BQU0sRUFBRTtBQUUxQixNQUFNQyxhQUFhLEdBQUdGLE9BQU8sQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDRCxRQUFRLENBQUM7QUFFNUQsTUFBTUksV0FBVyxHQUFHLElBQUlKLFFBQVEsQ0FBQ0ssTUFBTSxDQUFDO0VBQ3BDQyxVQUFVLEVBQUU7SUFBRUMsSUFBSSxFQUFFQyxLQUFLO0lBQUVDLE9BQU8sRUFBRTtFQUFLLENBQUM7RUFDMUNDLEtBQUssRUFBRTtJQUFFSCxJQUFJLEVBQUVJLE1BQU07SUFBRUMsUUFBUSxFQUFFO0VBQUssQ0FBQztFQUN2Q0MsV0FBVyxFQUFFO0lBQUVOLElBQUksRUFBRUksTUFBTTtJQUFFRixPQUFPLEVBQUUsSUFBSTtJQUFFRyxRQUFRLEVBQUU7RUFBSyxDQUFDO0VBQzVERSxhQUFhLEVBQUU7SUFBRVAsSUFBSSxFQUFFSSxNQUFNO0lBQUVGLE9BQU8sRUFBRSxJQUFJO0lBQUVHLFFBQVEsRUFBRTtFQUFLLENBQUM7RUFDOURHLFNBQVMsRUFBRTtJQUFFUixJQUFJLEVBQUVJLE1BQU07SUFBRUYsT0FBTyxFQUFFO0VBQUssQ0FBQztFQUMxQ08sV0FBVyxFQUFFO0lBQUVULElBQUksRUFBRVUsTUFBTTtJQUFFTCxRQUFRLEVBQUU7RUFBSyxDQUFDO0VBQzdDTSxPQUFPLEVBQUU7SUFBRVgsSUFBSSxFQUFFVSxNQUFNO0lBQUVSLE9BQU8sRUFBRTtFQUFFO0FBR3hDLENBQUMsRUFBRTtFQUFFVSxVQUFVLEVBQUU7SUFBRUMsU0FBUyxFQUFFLFlBQVk7SUFBRUMsU0FBUyxFQUFFO0VBQWE7QUFBRSxDQUFDLENBQUM7QUFDeEVqQixXQUFXLENBQUNrQixNQUFNLENBQUNuQixhQUFhLEVBQUU7RUFBQ29CLFNBQVMsRUFBRTtBQUFTLENBQUMsQ0FBQztBQUV6REMsTUFBTSxDQUFDQyxPQUFPLEdBQUd6QixRQUFRLENBQUMwQixLQUFLLENBQUMsT0FBTyxFQUFFdEIsV0FBVyxDQUFDIn0=","map":{"version":3,"names":["mongoose","require","config","AutoIncrement","orderSchema","Schema","orderItems","type","Array","default","email","String","required","orderStatus","paymentStatus","orderType","orderAmount","Number","tableId","timestamps","createdAt","updatedAt","plugin","inc_field","module","exports","model"],"sourceRoot":"/Users/prashant/Desktop/social-backend/model/","sources":["order.js"],"sourcesContent":["const mongoose = require(\"mongoose\");\nrequire('dotenv').config()\n\nconst AutoIncrement = require('mongoose-sequence')(mongoose);\n\nconst orderSchema = new mongoose.Schema({\n    orderItems: { type: Array, default: null },\n    email: { type: String, required: true },\n    orderStatus: { type: String, default: null, required: true },\n    paymentStatus: { type: String, default: null, required: true },\n    orderType: { type: String, default: null },\n    orderAmount: { type: Number, required: true },\n    tableId: { type: Number, default: 1 },\n    \n\n}, { timestamps: { createdAt: 'created_at', updatedAt: 'updated_at' } });\norderSchema.plugin(AutoIncrement, {inc_field: 'orderId'});\n\nmodule.exports = mongoose.model(\"order\", orderSchema);"],"mappings":"AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAU,CAAC;AACpCA,OAAO,CAAC,QAAQ,CAAC,CAACC,MAAM,EAAE;AAE1B,MAAMC,aAAa,GAAGF,OAAO,CAAC,mBAAmB,CAAC,CAACD,QAAQ,CAAC;AAE5D,MAAMI,WAAW,GAAG,IAAIJ,QAAQ,CAACK,MAAM,CAAC;EACpCC,UAAU,EAAE;IAAEC,IAAI,EAAEC,KAAK;IAAEC,OAAO,EAAE;EAAK,CAAC;EAC1CC,KAAK,EAAE;IAAEH,IAAI,EAAEI,MAAM;IAAEC,QAAQ,EAAE;EAAK,CAAC;EACvCC,WAAW,EAAE;IAAEN,IAAI,EAAEI,MAAM;IAAEF,OAAO,EAAE,IAAI;IAAEG,QAAQ,EAAE;EAAK,CAAC;EAC5DE,aAAa,EAAE;IAAEP,IAAI,EAAEI,MAAM;IAAEF,OAAO,EAAE,IAAI;IAAEG,QAAQ,EAAE;EAAK,CAAC;EAC9DG,SAAS,EAAE;IAAER,IAAI,EAAEI,MAAM;IAAEF,OAAO,EAAE;EAAK,CAAC;EAC1CO,WAAW,EAAE;IAAET,IAAI,EAAEU,MAAM;IAAEL,QAAQ,EAAE;EAAK,CAAC;EAC7CM,OAAO,EAAE;IAAEX,IAAI,EAAEU,MAAM;IAAER,OAAO,EAAE;EAAE;AAGxC,CAAC,EAAE;EAAEU,UAAU,EAAE;IAAEC,SAAS,EAAE,YAAY;IAAEC,SAAS,EAAE;EAAa;AAAE,CAAC,CAAC;AACxEjB,WAAW,CAACkB,MAAM,CAACnB,aAAa,EAAE;EAACoB,SAAS,EAAE;AAAS,CAAC,CAAC;AAEzDC,MAAM,CAACC,OAAO,GAAGzB,QAAQ,CAAC0B,KAAK,CAAC,OAAO,EAAEtB,WAAW,CAAC"}},"mtime":1668924520950},"{\"assumptions\":{},\"sourceRoot\":\"/Users/prashant/Desktop/social-backend/model/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/prashant/Desktop/social-backend\",\"filename\":\"/Users/prashant/Desktop/social-backend/model/table.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/prashant/Desktop/social-backend\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.20.2:development":{"value":{"code":"const mongoose = require(\"mongoose\");\nconst AutoIncrement = require('mongoose-sequence')(mongoose);\nconst tableSchema = new mongoose.Schema({\n  emailId: {\n    type: String,\n    default: null\n  },\n  currentOrders: {\n    type: Array,\n    default: null\n  },\n  status: {\n    type: String,\n    default: null\n  },\n  occupiedAt: {\n    type: Date,\n    default: null\n  },\n  capacity: {\n    type: Number,\n    default: null\n  }\n}, {\n  timestamps: {\n    createdAt: 'created_at',\n    updatedAt: 'updated_at'\n  }\n});\ntableSchema.plugin(AutoIncrement, {\n  inc_field: 'tableNumber'\n});\nmodule.exports = mongoose.model(\"table\", tableSchema);\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtb25nb29zZSIsInJlcXVpcmUiLCJBdXRvSW5jcmVtZW50IiwidGFibGVTY2hlbWEiLCJTY2hlbWEiLCJlbWFpbElkIiwidHlwZSIsIlN0cmluZyIsImRlZmF1bHQiLCJjdXJyZW50T3JkZXJzIiwiQXJyYXkiLCJzdGF0dXMiLCJvY2N1cGllZEF0IiwiRGF0ZSIsImNhcGFjaXR5IiwiTnVtYmVyIiwidGltZXN0YW1wcyIsImNyZWF0ZWRBdCIsInVwZGF0ZWRBdCIsInBsdWdpbiIsImluY19maWVsZCIsIm1vZHVsZSIsImV4cG9ydHMiLCJtb2RlbCJdLCJzb3VyY2VSb290IjoiL1VzZXJzL3ByYXNoYW50L0Rlc2t0b3Avc29jaWFsLWJhY2tlbmQvbW9kZWwvIiwic291cmNlcyI6WyJ0YWJsZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBtb25nb29zZSA9IHJlcXVpcmUoXCJtb25nb29zZVwiKTtcbmNvbnN0IEF1dG9JbmNyZW1lbnQgPSByZXF1aXJlKCdtb25nb29zZS1zZXF1ZW5jZScpKG1vbmdvb3NlKTtcblxuY29uc3QgdGFibGVTY2hlbWEgPSBuZXcgbW9uZ29vc2UuU2NoZW1hKHtcbiAgICBlbWFpbElkOiB7IHR5cGU6IFN0cmluZywgZGVmYXVsdDogbnVsbCB9LFxuICAgIGN1cnJlbnRPcmRlcnM6IHsgdHlwZTogQXJyYXksIGRlZmF1bHQ6IG51bGwgfSxcbiAgICBzdGF0dXM6IHsgdHlwZTogU3RyaW5nICwgZGVmYXVsdDogbnVsbCB9LFxuICAgIG9jY3VwaWVkQXQ6IHsgdHlwZTogRGF0ZSwgZGVmYXVsdDogbnVsbCAgfSxcbiAgICBjYXBhY2l0eTogeyB0eXBlOiBOdW1iZXIsIGRlZmF1bHQ6IG51bGwgIH1cblxufSwgeyB0aW1lc3RhbXBzOiB7IGNyZWF0ZWRBdDogJ2NyZWF0ZWRfYXQnLCB1cGRhdGVkQXQ6ICd1cGRhdGVkX2F0JyB9IH0pO1xudGFibGVTY2hlbWEucGx1Z2luKEF1dG9JbmNyZW1lbnQsIHtpbmNfZmllbGQ6ICd0YWJsZU51bWJlcid9KTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb25nb29zZS5tb2RlbChcInRhYmxlXCIsIHRhYmxlU2NoZW1hKTsiXSwibWFwcGluZ3MiOiJBQUFBLE1BQU1BLFFBQVEsR0FBR0MsT0FBTyxDQUFDLFVBQVUsQ0FBQztBQUNwQyxNQUFNQyxhQUFhLEdBQUdELE9BQU8sQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDRCxRQUFRLENBQUM7QUFFNUQsTUFBTUcsV0FBVyxHQUFHLElBQUlILFFBQVEsQ0FBQ0ksTUFBTSxDQUFDO0VBQ3BDQyxPQUFPLEVBQUU7SUFBRUMsSUFBSSxFQUFFQyxNQUFNO0lBQUVDLE9BQU8sRUFBRTtFQUFLLENBQUM7RUFDeENDLGFBQWEsRUFBRTtJQUFFSCxJQUFJLEVBQUVJLEtBQUs7SUFBRUYsT0FBTyxFQUFFO0VBQUssQ0FBQztFQUM3Q0csTUFBTSxFQUFFO0lBQUVMLElBQUksRUFBRUMsTUFBTTtJQUFHQyxPQUFPLEVBQUU7RUFBSyxDQUFDO0VBQ3hDSSxVQUFVLEVBQUU7SUFBRU4sSUFBSSxFQUFFTyxJQUFJO0lBQUVMLE9BQU8sRUFBRTtFQUFNLENBQUM7RUFDMUNNLFFBQVEsRUFBRTtJQUFFUixJQUFJLEVBQUVTLE1BQU07SUFBRVAsT0FBTyxFQUFFO0VBQU07QUFFN0MsQ0FBQyxFQUFFO0VBQUVRLFVBQVUsRUFBRTtJQUFFQyxTQUFTLEVBQUUsWUFBWTtJQUFFQyxTQUFTLEVBQUU7RUFBYTtBQUFFLENBQUMsQ0FBQztBQUN4RWYsV0FBVyxDQUFDZ0IsTUFBTSxDQUFDakIsYUFBYSxFQUFFO0VBQUNrQixTQUFTLEVBQUU7QUFBYSxDQUFDLENBQUM7QUFFN0RDLE1BQU0sQ0FBQ0MsT0FBTyxHQUFHdEIsUUFBUSxDQUFDdUIsS0FBSyxDQUFDLE9BQU8sRUFBRXBCLFdBQVcsQ0FBQyJ9","map":{"version":3,"names":["mongoose","require","AutoIncrement","tableSchema","Schema","emailId","type","String","default","currentOrders","Array","status","occupiedAt","Date","capacity","Number","timestamps","createdAt","updatedAt","plugin","inc_field","module","exports","model"],"sourceRoot":"/Users/prashant/Desktop/social-backend/model/","sources":["table.js"],"sourcesContent":["const mongoose = require(\"mongoose\");\nconst AutoIncrement = require('mongoose-sequence')(mongoose);\n\nconst tableSchema = new mongoose.Schema({\n    emailId: { type: String, default: null },\n    currentOrders: { type: Array, default: null },\n    status: { type: String , default: null },\n    occupiedAt: { type: Date, default: null  },\n    capacity: { type: Number, default: null  }\n\n}, { timestamps: { createdAt: 'created_at', updatedAt: 'updated_at' } });\ntableSchema.plugin(AutoIncrement, {inc_field: 'tableNumber'});\n\nmodule.exports = mongoose.model(\"table\", tableSchema);"],"mappings":"AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAU,CAAC;AACpC,MAAMC,aAAa,GAAGD,OAAO,CAAC,mBAAmB,CAAC,CAACD,QAAQ,CAAC;AAE5D,MAAMG,WAAW,GAAG,IAAIH,QAAQ,CAACI,MAAM,CAAC;EACpCC,OAAO,EAAE;IAAEC,IAAI,EAAEC,MAAM;IAAEC,OAAO,EAAE;EAAK,CAAC;EACxCC,aAAa,EAAE;IAAEH,IAAI,EAAEI,KAAK;IAAEF,OAAO,EAAE;EAAK,CAAC;EAC7CG,MAAM,EAAE;IAAEL,IAAI,EAAEC,MAAM;IAAGC,OAAO,EAAE;EAAK,CAAC;EACxCI,UAAU,EAAE;IAAEN,IAAI,EAAEO,IAAI;IAAEL,OAAO,EAAE;EAAM,CAAC;EAC1CM,QAAQ,EAAE;IAAER,IAAI,EAAES,MAAM;IAAEP,OAAO,EAAE;EAAM;AAE7C,CAAC,EAAE;EAAEQ,UAAU,EAAE;IAAEC,SAAS,EAAE,YAAY;IAAEC,SAAS,EAAE;EAAa;AAAE,CAAC,CAAC;AACxEf,WAAW,CAACgB,MAAM,CAACjB,aAAa,EAAE;EAACkB,SAAS,EAAE;AAAa,CAAC,CAAC;AAE7DC,MAAM,CAACC,OAAO,GAAGtB,QAAQ,CAACuB,KAAK,CAAC,OAAO,EAAEpB,WAAW,CAAC"}},"mtime":1668926688575},"{\"assumptions\":{},\"sourceRoot\":\"/Users/prashant/Desktop/social-backend/model/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/prashant/Desktop/social-backend\",\"filename\":\"/Users/prashant/Desktop/social-backend/model/seq.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/prashant/Desktop/social-backend\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.20.2:development":{"value":{"code":"const mongoose = require(\"mongoose\");\nconst seqSchema = new mongoose.Schema({\n  // seq_name: {type: String, unique: true, default: null },\n  _id: {\n    type: String,\n    required: true\n  },\n  seq_val: {\n    type: Number,\n    required: true,\n    default: 1\n  }\n});\nmodule.exports = mongoose.model(\"seq\", seqSchema);\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtb25nb29zZSIsInJlcXVpcmUiLCJzZXFTY2hlbWEiLCJTY2hlbWEiLCJfaWQiLCJ0eXBlIiwiU3RyaW5nIiwicmVxdWlyZWQiLCJzZXFfdmFsIiwiTnVtYmVyIiwiZGVmYXVsdCIsIm1vZHVsZSIsImV4cG9ydHMiLCJtb2RlbCJdLCJzb3VyY2VSb290IjoiL1VzZXJzL3ByYXNoYW50L0Rlc2t0b3Avc29jaWFsLWJhY2tlbmQvbW9kZWwvIiwic291cmNlcyI6WyJzZXEuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgbW9uZ29vc2UgPSByZXF1aXJlKFwibW9uZ29vc2VcIik7XG5cbmNvbnN0IHNlcVNjaGVtYSA9IG5ldyBtb25nb29zZS5TY2hlbWEoe1xuICAgIC8vIHNlcV9uYW1lOiB7dHlwZTogU3RyaW5nLCB1bmlxdWU6IHRydWUsIGRlZmF1bHQ6IG51bGwgfSxcbiAgICBfaWQ6IHsgdHlwZTogU3RyaW5nLCByZXF1aXJlZDogdHJ1ZSB9LFxuICAgIHNlcV92YWw6IHsgdHlwZTogTnVtYmVyLCByZXF1aXJlZDogdHJ1ZSwgZGVmYXVsdDogMSB9XG5cbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vbmdvb3NlLm1vZGVsKFwic2VxXCIsIHNlcVNjaGVtYSk7Il0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxRQUFRLEdBQUdDLE9BQU8sQ0FBQyxVQUFVLENBQUM7QUFFcEMsTUFBTUMsU0FBUyxHQUFHLElBQUlGLFFBQVEsQ0FBQ0csTUFBTSxDQUFDO0VBQ2xDO0VBQ0FDLEdBQUcsRUFBRTtJQUFFQyxJQUFJLEVBQUVDLE1BQU07SUFBRUMsUUFBUSxFQUFFO0VBQUssQ0FBQztFQUNyQ0MsT0FBTyxFQUFFO0lBQUVILElBQUksRUFBRUksTUFBTTtJQUFFRixRQUFRLEVBQUUsSUFBSTtJQUFFRyxPQUFPLEVBQUU7RUFBRTtBQUV4RCxDQUFDLENBQUM7QUFFRkMsTUFBTSxDQUFDQyxPQUFPLEdBQUdaLFFBQVEsQ0FBQ2EsS0FBSyxDQUFDLEtBQUssRUFBRVgsU0FBUyxDQUFDIn0=","map":{"version":3,"names":["mongoose","require","seqSchema","Schema","_id","type","String","required","seq_val","Number","default","module","exports","model"],"sourceRoot":"/Users/prashant/Desktop/social-backend/model/","sources":["seq.js"],"sourcesContent":["const mongoose = require(\"mongoose\");\n\nconst seqSchema = new mongoose.Schema({\n    // seq_name: {type: String, unique: true, default: null },\n    _id: { type: String, required: true },\n    seq_val: { type: Number, required: true, default: 1 }\n\n});\n\nmodule.exports = mongoose.model(\"seq\", seqSchema);"],"mappings":"AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAU,CAAC;AAEpC,MAAMC,SAAS,GAAG,IAAIF,QAAQ,CAACG,MAAM,CAAC;EAClC;EACAC,GAAG,EAAE;IAAEC,IAAI,EAAEC,MAAM;IAAEC,QAAQ,EAAE;EAAK,CAAC;EACrCC,OAAO,EAAE;IAAEH,IAAI,EAAEI,MAAM;IAAEF,QAAQ,EAAE,IAAI;IAAEG,OAAO,EAAE;EAAE;AAExD,CAAC,CAAC;AAEFC,MAAM,CAACC,OAAO,GAAGZ,QAAQ,CAACa,KAAK,CAAC,KAAK,EAAEX,SAAS,CAAC"}},"mtime":1668204154246},"{\"assumptions\":{},\"sourceRoot\":\"/Users/prashant/Desktop/social-backend/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/prashant/Desktop/social-backend\",\"filename\":\"/Users/prashant/Desktop/social-backend/routes/table.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/prashant/Desktop/social-backend\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.20.2:development":{"value":{"code":"// const tableSchema = new mongoose.Schema({\n//     tableId: { type: Number, required: true, unique: true },\n//     emailId: { type: String, default: null },\n//     currentOrders: { type: Array, default: null },\n//     status: { type: String , default: null },\n//     occupiedAt: { type: Date, default: null  }\n// }, { timestamps: { createdAt: 'created_at', updatedAt: 'updated_at' } });\n\nconst Table = require(\"../model/table\");\nconst Order = require(\"../model/order\");\nconst Seq = require(\"../model/seq\");\nconst express = require('express');\nconst router = express.Router();\n// const bcrypt = require('bcrypt')\n// const jwt = require(\"jsonwebtoken\");\n\nasync function getValueForNextSequence(sequenceOfName) {\n  console.log('sequenceOfName', sequenceOfName);\n  let filter = {\n    seq_name: sequenceOfName\n  };\n  let updates = {\n    $inc: {\n      seq_val: 1\n    }\n  };\n  var sequenceDoc = await Seq.findOneAndUpdate(filter, updates, {\n    returnOriginal: false\n  });\n  console.log('sequenceDoc', sequenceDoc);\n  return sequenceDoc.seq_val;\n}\nrouter.post(\"/createTable\", async (req, res) => {\n  try {\n    let {\n      capacity\n    } = req.body;\n    let data = await Table.create({\n      capacity: capacity\n    });\n    res.status(200).json({\n      data: data\n    });\n  } catch (err) {\n    res.status(500).json(\"Server Error!\");\n    console.log(err);\n  }\n});\nmodule.exports = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJUYWJsZSIsInJlcXVpcmUiLCJPcmRlciIsIlNlcSIsImV4cHJlc3MiLCJyb3V0ZXIiLCJSb3V0ZXIiLCJnZXRWYWx1ZUZvck5leHRTZXF1ZW5jZSIsInNlcXVlbmNlT2ZOYW1lIiwiY29uc29sZSIsImxvZyIsImZpbHRlciIsInNlcV9uYW1lIiwidXBkYXRlcyIsIiRpbmMiLCJzZXFfdmFsIiwic2VxdWVuY2VEb2MiLCJmaW5kT25lQW5kVXBkYXRlIiwicmV0dXJuT3JpZ2luYWwiLCJwb3N0IiwicmVxIiwicmVzIiwiY2FwYWNpdHkiLCJib2R5IiwiZGF0YSIsImNyZWF0ZSIsInN0YXR1cyIsImpzb24iLCJlcnIiLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvcHJhc2hhbnQvRGVza3RvcC9zb2NpYWwtYmFja2VuZC9yb3V0ZXMvIiwic291cmNlcyI6WyJ0YWJsZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBjb25zdCB0YWJsZVNjaGVtYSA9IG5ldyBtb25nb29zZS5TY2hlbWEoe1xuLy8gICAgIHRhYmxlSWQ6IHsgdHlwZTogTnVtYmVyLCByZXF1aXJlZDogdHJ1ZSwgdW5pcXVlOiB0cnVlIH0sXG4vLyAgICAgZW1haWxJZDogeyB0eXBlOiBTdHJpbmcsIGRlZmF1bHQ6IG51bGwgfSxcbi8vICAgICBjdXJyZW50T3JkZXJzOiB7IHR5cGU6IEFycmF5LCBkZWZhdWx0OiBudWxsIH0sXG4vLyAgICAgc3RhdHVzOiB7IHR5cGU6IFN0cmluZyAsIGRlZmF1bHQ6IG51bGwgfSxcbi8vICAgICBvY2N1cGllZEF0OiB7IHR5cGU6IERhdGUsIGRlZmF1bHQ6IG51bGwgIH1cbi8vIH0sIHsgdGltZXN0YW1wczogeyBjcmVhdGVkQXQ6ICdjcmVhdGVkX2F0JywgdXBkYXRlZEF0OiAndXBkYXRlZF9hdCcgfSB9KTtcblxuXG5jb25zdCBUYWJsZSA9IHJlcXVpcmUoXCIuLi9tb2RlbC90YWJsZVwiKTtcbmNvbnN0IE9yZGVyID0gcmVxdWlyZShcIi4uL21vZGVsL29yZGVyXCIpO1xuY29uc3QgU2VxID0gcmVxdWlyZShcIi4uL21vZGVsL3NlcVwiKTtcbmNvbnN0IGV4cHJlc3MgPSByZXF1aXJlKCdleHByZXNzJylcbmNvbnN0IHJvdXRlciA9IGV4cHJlc3MuUm91dGVyKCk7XG4vLyBjb25zdCBiY3J5cHQgPSByZXF1aXJlKCdiY3J5cHQnKVxuLy8gY29uc3Qgand0ID0gcmVxdWlyZShcImpzb253ZWJ0b2tlblwiKTtcblxuYXN5bmMgZnVuY3Rpb24gZ2V0VmFsdWVGb3JOZXh0U2VxdWVuY2Uoc2VxdWVuY2VPZk5hbWUpIHtcblxuICAgIGNvbnNvbGUubG9nKCdzZXF1ZW5jZU9mTmFtZScsIHNlcXVlbmNlT2ZOYW1lKVxuICAgIGxldCBmaWx0ZXIgPSB7IHNlcV9uYW1lOiBzZXF1ZW5jZU9mTmFtZSB9XG4gICAgbGV0IHVwZGF0ZXMgPSB7ICRpbmM6IHsgc2VxX3ZhbDogMSB9IH1cbiAgICB2YXIgc2VxdWVuY2VEb2MgPSBhd2FpdCBTZXEuZmluZE9uZUFuZFVwZGF0ZShcbiAgICAgICAgZmlsdGVyLFxuICAgICAgICB1cGRhdGVzLFxuICAgICAgICB7IHJldHVybk9yaWdpbmFsOiBmYWxzZSB9XG4gICAgKTtcbiAgICBjb25zb2xlLmxvZygnc2VxdWVuY2VEb2MnLCBzZXF1ZW5jZURvYylcbiAgICByZXR1cm4gc2VxdWVuY2VEb2Muc2VxX3ZhbDtcbn1cblxuXG5yb3V0ZXIucG9zdChcIi9jcmVhdGVUYWJsZVwiLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICB0cnkge1xuICAgICAgICBsZXQgeyBjYXBhY2l0eSB9ID0gcmVxLmJvZHlcbiAgICAgICAgbGV0IGRhdGEgPSBhd2FpdCBUYWJsZS5jcmVhdGUoeyBjYXBhY2l0eTogY2FwYWNpdHkgfSlcbiAgICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyBkYXRhOiBkYXRhIH0pO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICByZXMuc3RhdHVzKDUwMCkuanNvbihcIlNlcnZlciBFcnJvciFcIilcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICB9XG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSByb3V0ZXI7Il0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFHQSxNQUFNQSxLQUFLLEdBQUdDLE9BQU8sQ0FBQyxnQkFBZ0IsQ0FBQztBQUN2QyxNQUFNQyxLQUFLLEdBQUdELE9BQU8sQ0FBQyxnQkFBZ0IsQ0FBQztBQUN2QyxNQUFNRSxHQUFHLEdBQUdGLE9BQU8sQ0FBQyxjQUFjLENBQUM7QUFDbkMsTUFBTUcsT0FBTyxHQUFHSCxPQUFPLENBQUMsU0FBUyxDQUFDO0FBQ2xDLE1BQU1JLE1BQU0sR0FBR0QsT0FBTyxDQUFDRSxNQUFNLEVBQUU7QUFDL0I7QUFDQTs7QUFFQSxlQUFlQyx1QkFBdUIsQ0FBQ0MsY0FBYyxFQUFFO0VBRW5EQyxPQUFPLENBQUNDLEdBQUcsQ0FBQyxnQkFBZ0IsRUFBRUYsY0FBYyxDQUFDO0VBQzdDLElBQUlHLE1BQU0sR0FBRztJQUFFQyxRQUFRLEVBQUVKO0VBQWUsQ0FBQztFQUN6QyxJQUFJSyxPQUFPLEdBQUc7SUFBRUMsSUFBSSxFQUFFO01BQUVDLE9BQU8sRUFBRTtJQUFFO0VBQUUsQ0FBQztFQUN0QyxJQUFJQyxXQUFXLEdBQUcsTUFBTWIsR0FBRyxDQUFDYyxnQkFBZ0IsQ0FDeENOLE1BQU0sRUFDTkUsT0FBTyxFQUNQO0lBQUVLLGNBQWMsRUFBRTtFQUFNLENBQUMsQ0FDNUI7RUFDRFQsT0FBTyxDQUFDQyxHQUFHLENBQUMsYUFBYSxFQUFFTSxXQUFXLENBQUM7RUFDdkMsT0FBT0EsV0FBVyxDQUFDRCxPQUFPO0FBQzlCO0FBR0FWLE1BQU0sQ0FBQ2MsSUFBSSxDQUFDLGNBQWMsRUFBRSxPQUFPQyxHQUFHLEVBQUVDLEdBQUcsS0FBSztFQUM1QyxJQUFJO0lBQ0EsSUFBSTtNQUFFQztJQUFTLENBQUMsR0FBR0YsR0FBRyxDQUFDRyxJQUFJO0lBQzNCLElBQUlDLElBQUksR0FBRyxNQUFNeEIsS0FBSyxDQUFDeUIsTUFBTSxDQUFDO01BQUVILFFBQVEsRUFBRUE7SUFBUyxDQUFDLENBQUM7SUFDckRELEdBQUcsQ0FBQ0ssTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7TUFBRUgsSUFBSSxFQUFFQTtJQUFLLENBQUMsQ0FBQztFQUN4QyxDQUFDLENBQUMsT0FBT0ksR0FBRyxFQUFFO0lBQ1ZQLEdBQUcsQ0FBQ0ssTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUMsZUFBZSxDQUFDO0lBQ3JDbEIsT0FBTyxDQUFDQyxHQUFHLENBQUNrQixHQUFHLENBQUM7RUFDcEI7QUFDSixDQUFDLENBQUM7QUFFRkMsTUFBTSxDQUFDQyxPQUFPLEdBQUd6QixNQUFNIn0=","map":{"version":3,"names":["Table","require","Order","Seq","express","router","Router","getValueForNextSequence","sequenceOfName","console","log","filter","seq_name","updates","$inc","seq_val","sequenceDoc","findOneAndUpdate","returnOriginal","post","req","res","capacity","body","data","create","status","json","err","module","exports"],"sourceRoot":"/Users/prashant/Desktop/social-backend/routes/","sources":["table.js"],"sourcesContent":["// const tableSchema = new mongoose.Schema({\n//     tableId: { type: Number, required: true, unique: true },\n//     emailId: { type: String, default: null },\n//     currentOrders: { type: Array, default: null },\n//     status: { type: String , default: null },\n//     occupiedAt: { type: Date, default: null  }\n// }, { timestamps: { createdAt: 'created_at', updatedAt: 'updated_at' } });\n\n\nconst Table = require(\"../model/table\");\nconst Order = require(\"../model/order\");\nconst Seq = require(\"../model/seq\");\nconst express = require('express')\nconst router = express.Router();\n// const bcrypt = require('bcrypt')\n// const jwt = require(\"jsonwebtoken\");\n\nasync function getValueForNextSequence(sequenceOfName) {\n\n    console.log('sequenceOfName', sequenceOfName)\n    let filter = { seq_name: sequenceOfName }\n    let updates = { $inc: { seq_val: 1 } }\n    var sequenceDoc = await Seq.findOneAndUpdate(\n        filter,\n        updates,\n        { returnOriginal: false }\n    );\n    console.log('sequenceDoc', sequenceDoc)\n    return sequenceDoc.seq_val;\n}\n\n\nrouter.post(\"/createTable\", async (req, res) => {\n    try {\n        let { capacity } = req.body\n        let data = await Table.create({ capacity: capacity })\n        res.status(200).json({ data: data });\n    } catch (err) {\n        res.status(500).json(\"Server Error!\")\n        console.log(err);\n    }\n});\n\nmodule.exports = router;"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA,MAAMA,KAAK,GAAGC,OAAO,CAAC,gBAAgB,CAAC;AACvC,MAAMC,KAAK,GAAGD,OAAO,CAAC,gBAAgB,CAAC;AACvC,MAAME,GAAG,GAAGF,OAAO,CAAC,cAAc,CAAC;AACnC,MAAMG,OAAO,GAAGH,OAAO,CAAC,SAAS,CAAC;AAClC,MAAMI,MAAM,GAAGD,OAAO,CAACE,MAAM,EAAE;AAC/B;AACA;;AAEA,eAAeC,uBAAuB,CAACC,cAAc,EAAE;EAEnDC,OAAO,CAACC,GAAG,CAAC,gBAAgB,EAAEF,cAAc,CAAC;EAC7C,IAAIG,MAAM,GAAG;IAAEC,QAAQ,EAAEJ;EAAe,CAAC;EACzC,IAAIK,OAAO,GAAG;IAAEC,IAAI,EAAE;MAAEC,OAAO,EAAE;IAAE;EAAE,CAAC;EACtC,IAAIC,WAAW,GAAG,MAAMb,GAAG,CAACc,gBAAgB,CACxCN,MAAM,EACNE,OAAO,EACP;IAAEK,cAAc,EAAE;EAAM,CAAC,CAC5B;EACDT,OAAO,CAACC,GAAG,CAAC,aAAa,EAAEM,WAAW,CAAC;EACvC,OAAOA,WAAW,CAACD,OAAO;AAC9B;AAGAV,MAAM,CAACc,IAAI,CAAC,cAAc,EAAE,OAAOC,GAAG,EAAEC,GAAG,KAAK;EAC5C,IAAI;IACA,IAAI;MAAEC;IAAS,CAAC,GAAGF,GAAG,CAACG,IAAI;IAC3B,IAAIC,IAAI,GAAG,MAAMxB,KAAK,CAACyB,MAAM,CAAC;MAAEH,QAAQ,EAAEA;IAAS,CAAC,CAAC;IACrDD,GAAG,CAACK,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAAEH,IAAI,EAAEA;IAAK,CAAC,CAAC;EACxC,CAAC,CAAC,OAAOI,GAAG,EAAE;IACVP,GAAG,CAACK,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC,eAAe,CAAC;IACrClB,OAAO,CAACC,GAAG,CAACkB,GAAG,CAAC;EACpB;AACJ,CAAC,CAAC;AAEFC,MAAM,CAACC,OAAO,GAAGzB,MAAM"}},"mtime":1668926686702},"{\"assumptions\":{},\"sourceRoot\":\"/Users/prashant/Desktop/social-backend/sse/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/prashant/Desktop/social-backend\",\"filename\":\"/Users/prashant/Desktop/social-backend/sse/index.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/prashant/Desktop/social-backend\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.20.2:development":{"value":{"code":"const SSE = require(\"express-sse\");\nconst sse = new SSE();\nmodule.exports = sse;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJTU0UiLCJyZXF1aXJlIiwic3NlIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL3ByYXNoYW50L0Rlc2t0b3Avc29jaWFsLWJhY2tlbmQvc3NlLyIsInNvdXJjZXMiOlsiaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgU1NFID0gcmVxdWlyZShcImV4cHJlc3Mtc3NlXCIpO1xuXG5jb25zdCBzc2UgPSBuZXcgU1NFKCk7XG5cbm1vZHVsZS5leHBvcnRzID0gc3NlOyJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTUEsR0FBRyxHQUFHQyxPQUFPLENBQUMsYUFBYSxDQUFDO0FBRWxDLE1BQU1DLEdBQUcsR0FBRyxJQUFJRixHQUFHLEVBQUU7QUFFckJHLE1BQU0sQ0FBQ0MsT0FBTyxHQUFHRixHQUFHIn0=","map":{"version":3,"names":["SSE","require","sse","module","exports"],"sourceRoot":"/Users/prashant/Desktop/social-backend/sse/","sources":["index.js"],"sourcesContent":["const SSE = require(\"express-sse\");\n\nconst sse = new SSE();\n\nmodule.exports = sse;"],"mappings":"AAAA,MAAMA,GAAG,GAAGC,OAAO,CAAC,aAAa,CAAC;AAElC,MAAMC,GAAG,GAAG,IAAIF,GAAG,EAAE;AAErBG,MAAM,CAACC,OAAO,GAAGF,GAAG"}},"mtime":1671272913293},"{\"assumptions\":{},\"sourceRoot\":\"/Users/prashant/Desktop/social-backend/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/prashant/Desktop/social-backend\",\"filename\":\"/Users/prashant/Desktop/social-backend/routes/sse.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/prashant/Desktop/social-backend\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.20.2:development":{"value":{"code":"const express = require(\"express\");\nconst sse = require(\"../sse\");\nconst router = express.Router();\nrouter.get(\"/stream\", sse.init);\nmodule.exports = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsInNzZSIsInJvdXRlciIsIlJvdXRlciIsImdldCIsImluaXQiLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvcHJhc2hhbnQvRGVza3RvcC9zb2NpYWwtYmFja2VuZC9yb3V0ZXMvIiwic291cmNlcyI6WyJzc2UuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZXhwcmVzcyA9IHJlcXVpcmUoXCJleHByZXNzXCIpO1xuY29uc3Qgc3NlID0gcmVxdWlyZShcIi4uL3NzZVwiKTtcblxuY29uc3Qgcm91dGVyID0gZXhwcmVzcy5Sb3V0ZXIoKTtcblxucm91dGVyLmdldChcIi9zdHJlYW1cIiwgc3NlLmluaXQpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IHJvdXRlcjsiXSwibWFwcGluZ3MiOiJBQUFBLE1BQU1BLE9BQU8sR0FBR0MsT0FBTyxDQUFDLFNBQVMsQ0FBQztBQUNsQyxNQUFNQyxHQUFHLEdBQUdELE9BQU8sQ0FBQyxRQUFRLENBQUM7QUFFN0IsTUFBTUUsTUFBTSxHQUFHSCxPQUFPLENBQUNJLE1BQU0sRUFBRTtBQUUvQkQsTUFBTSxDQUFDRSxHQUFHLENBQUMsU0FBUyxFQUFFSCxHQUFHLENBQUNJLElBQUksQ0FBQztBQUUvQkMsTUFBTSxDQUFDQyxPQUFPLEdBQUdMLE1BQU0ifQ==","map":{"version":3,"names":["express","require","sse","router","Router","get","init","module","exports"],"sourceRoot":"/Users/prashant/Desktop/social-backend/routes/","sources":["sse.js"],"sourcesContent":["const express = require(\"express\");\nconst sse = require(\"../sse\");\n\nconst router = express.Router();\n\nrouter.get(\"/stream\", sse.init);\n\nmodule.exports = router;"],"mappings":"AAAA,MAAMA,OAAO,GAAGC,OAAO,CAAC,SAAS,CAAC;AAClC,MAAMC,GAAG,GAAGD,OAAO,CAAC,QAAQ,CAAC;AAE7B,MAAME,MAAM,GAAGH,OAAO,CAACI,MAAM,EAAE;AAE/BD,MAAM,CAACE,GAAG,CAAC,SAAS,EAAEH,GAAG,CAACI,IAAI,CAAC;AAE/BC,MAAM,CAACC,OAAO,GAAGL,MAAM"}},"mtime":1671267043829},"{\"assumptions\":{},\"sourceRoot\":\"/Users/prashant/Desktop/social-backend/controllers/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/prashant/Desktop/social-backend\",\"filename\":\"/Users/prashant/Desktop/social-backend/controllers/orders.controller.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/prashant/Desktop/social-backend\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.20.2:development":{"value":{"code":"const {\n  getOrdersService,\n  createOrderService\n} = require(\"../services/order\");\nconst sse = require(\"../sse\");\nconst getOrdersController = async (req, res) => {\n  const result = await getOrdersService();\n  res.status(result.statusCode).json(result);\n};\nconst createOrderController = async (req, res) => {\n  const body = req.body;\n  const result = await createOrderService(body);\n  res.status(result.statusCode).json(result);\n  if (!result.error) {\n    //   emit post event\n    sse.send(result, \"order_created\");\n  }\n};\nmodule.exports = {\n  getOrdersController,\n  createOrderController\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJnZXRPcmRlcnNTZXJ2aWNlIiwiY3JlYXRlT3JkZXJTZXJ2aWNlIiwicmVxdWlyZSIsInNzZSIsImdldE9yZGVyc0NvbnRyb2xsZXIiLCJyZXEiLCJyZXMiLCJyZXN1bHQiLCJzdGF0dXMiLCJzdGF0dXNDb2RlIiwianNvbiIsImNyZWF0ZU9yZGVyQ29udHJvbGxlciIsImJvZHkiLCJlcnJvciIsInNlbmQiLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvcHJhc2hhbnQvRGVza3RvcC9zb2NpYWwtYmFja2VuZC9jb250cm9sbGVycy8iLCJzb3VyY2VzIjpbIm9yZGVycy5jb250cm9sbGVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHtcbiAgICBnZXRPcmRlcnNTZXJ2aWNlLFxuICAgIGNyZWF0ZU9yZGVyU2VydmljZSxcbiAgXG4gIH0gPSByZXF1aXJlKFwiLi4vc2VydmljZXMvb3JkZXJcIik7XG4gIGNvbnN0IHNzZSA9IHJlcXVpcmUoXCIuLi9zc2VcIik7XG4gIFxuICBjb25zdCBnZXRPcmRlcnNDb250cm9sbGVyID0gYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZ2V0T3JkZXJzU2VydmljZSgpO1xuICAgIHJlcy5zdGF0dXMocmVzdWx0LnN0YXR1c0NvZGUpLmpzb24ocmVzdWx0KTtcbiAgfTtcbiAgXG4gIGNvbnN0IGNyZWF0ZU9yZGVyQ29udHJvbGxlciA9IGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIGNvbnN0IGJvZHkgPSByZXEuYm9keTtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjcmVhdGVPcmRlclNlcnZpY2UoYm9keSk7XG4gICAgcmVzLnN0YXR1cyhyZXN1bHQuc3RhdHVzQ29kZSkuanNvbihyZXN1bHQpO1xuICAgIGlmICghcmVzdWx0LmVycm9yKSB7XG4gICAgICAvLyAgIGVtaXQgcG9zdCBldmVudFxuICAgICAgc3NlLnNlbmQocmVzdWx0LCBcIm9yZGVyX2NyZWF0ZWRcIilcbiAgICB9XG4gIH07XG4gIFxuICBtb2R1bGUuZXhwb3J0cyA9IHtcbiAgICBnZXRPcmRlcnNDb250cm9sbGVyLFxuICAgIGNyZWF0ZU9yZGVyQ29udHJvbGxlclxuICB9OyJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTTtFQUNGQSxnQkFBZ0I7RUFDaEJDO0FBRUYsQ0FBQyxHQUFHQyxPQUFPLENBQUMsbUJBQW1CLENBQUM7QUFDaEMsTUFBTUMsR0FBRyxHQUFHRCxPQUFPLENBQUMsUUFBUSxDQUFDO0FBRTdCLE1BQU1FLG1CQUFtQixHQUFHLE9BQU9DLEdBQUcsRUFBRUMsR0FBRyxLQUFLO0VBQzlDLE1BQU1DLE1BQU0sR0FBRyxNQUFNUCxnQkFBZ0IsRUFBRTtFQUN2Q00sR0FBRyxDQUFDRSxNQUFNLENBQUNELE1BQU0sQ0FBQ0UsVUFBVSxDQUFDLENBQUNDLElBQUksQ0FBQ0gsTUFBTSxDQUFDO0FBQzVDLENBQUM7QUFFRCxNQUFNSSxxQkFBcUIsR0FBRyxPQUFPTixHQUFHLEVBQUVDLEdBQUcsS0FBSztFQUNoRCxNQUFNTSxJQUFJLEdBQUdQLEdBQUcsQ0FBQ08sSUFBSTtFQUNyQixNQUFNTCxNQUFNLEdBQUcsTUFBTU4sa0JBQWtCLENBQUNXLElBQUksQ0FBQztFQUM3Q04sR0FBRyxDQUFDRSxNQUFNLENBQUNELE1BQU0sQ0FBQ0UsVUFBVSxDQUFDLENBQUNDLElBQUksQ0FBQ0gsTUFBTSxDQUFDO0VBQzFDLElBQUksQ0FBQ0EsTUFBTSxDQUFDTSxLQUFLLEVBQUU7SUFDakI7SUFDQVYsR0FBRyxDQUFDVyxJQUFJLENBQUNQLE1BQU0sRUFBRSxlQUFlLENBQUM7RUFDbkM7QUFDRixDQUFDO0FBRURRLE1BQU0sQ0FBQ0MsT0FBTyxHQUFHO0VBQ2ZaLG1CQUFtQjtFQUNuQk87QUFDRixDQUFDIn0=","map":{"version":3,"names":["getOrdersService","createOrderService","require","sse","getOrdersController","req","res","result","status","statusCode","json","createOrderController","body","error","send","module","exports"],"sourceRoot":"/Users/prashant/Desktop/social-backend/controllers/","sources":["orders.controller.js"],"sourcesContent":["const {\n    getOrdersService,\n    createOrderService,\n  \n  } = require(\"../services/order\");\n  const sse = require(\"../sse\");\n  \n  const getOrdersController = async (req, res) => {\n    const result = await getOrdersService();\n    res.status(result.statusCode).json(result);\n  };\n  \n  const createOrderController = async (req, res) => {\n    const body = req.body;\n    const result = await createOrderService(body);\n    res.status(result.statusCode).json(result);\n    if (!result.error) {\n      //   emit post event\n      sse.send(result, \"order_created\")\n    }\n  };\n  \n  module.exports = {\n    getOrdersController,\n    createOrderController\n  };"],"mappings":"AAAA,MAAM;EACFA,gBAAgB;EAChBC;AAEF,CAAC,GAAGC,OAAO,CAAC,mBAAmB,CAAC;AAChC,MAAMC,GAAG,GAAGD,OAAO,CAAC,QAAQ,CAAC;AAE7B,MAAME,mBAAmB,GAAG,OAAOC,GAAG,EAAEC,GAAG,KAAK;EAC9C,MAAMC,MAAM,GAAG,MAAMP,gBAAgB,EAAE;EACvCM,GAAG,CAACE,MAAM,CAACD,MAAM,CAACE,UAAU,CAAC,CAACC,IAAI,CAACH,MAAM,CAAC;AAC5C,CAAC;AAED,MAAMI,qBAAqB,GAAG,OAAON,GAAG,EAAEC,GAAG,KAAK;EAChD,MAAMM,IAAI,GAAGP,GAAG,CAACO,IAAI;EACrB,MAAML,MAAM,GAAG,MAAMN,kBAAkB,CAACW,IAAI,CAAC;EAC7CN,GAAG,CAACE,MAAM,CAACD,MAAM,CAACE,UAAU,CAAC,CAACC,IAAI,CAACH,MAAM,CAAC;EAC1C,IAAI,CAACA,MAAM,CAACM,KAAK,EAAE;IACjB;IACAV,GAAG,CAACW,IAAI,CAACP,MAAM,EAAE,eAAe,CAAC;EACnC;AACF,CAAC;AAEDQ,MAAM,CAACC,OAAO,GAAG;EACfZ,mBAAmB;EACnBO;AACF,CAAC"}},"mtime":1671408893154},"{\"assumptions\":{},\"sourceRoot\":\"/Users/prashant/Desktop/social-backend/services/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/prashant/Desktop/social-backend\",\"filename\":\"/Users/prashant/Desktop/social-backend/services/order.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/prashant/Desktop/social-backend\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.20.2:development":{"value":{"code":"const Order = require(\"../model/order\");\nconst Table = require(\"../model/table\");\nconst sse = require(\"../sse\");\nconst getOrdersService = async () => {\n  //   try {\n  //     const posts = await PostModel.find();\n  //     const _length = posts.length;\n  //     const message = _length === 0 ? \"Not found\" : \"success\";\n  //     const error = _length === 0 ? true : false;\n  //     const statusCode = _length === 0 ? 404 : 200;\n  //     return { data: posts, error, message, statusCode };\n  //   } catch (error) {\n  //     return {\n  //       data: [],\n  //       error: true,\n  //       message: \"Sorry an error occurred\",\n  //       statusCode: 500,\n  //     };\n  //   }\n  try {\n    const orders = await Order.find();\n    const _length = orders.length;\n    const message = _length === 0 ? \"Not found\" : \"success\";\n    const error = _length === 0 ? true : false;\n    const statusCode = _length === 0 ? 404 : 200;\n    return {\n      data: orders,\n      error,\n      message,\n      statusCode\n    };\n  } catch (err) {\n    return {\n      data: [],\n      error: true,\n      message: \"Sorry an error occurred\",\n      statusCode: 500\n    };\n  }\n};\nconst createOrderService = async body => {\n  try {\n    let {\n      orderItems,\n      email,\n      orderStatus,\n      paymentStatus,\n      orderType,\n      orderAmount,\n      tableId\n    } = body;\n    const order = await Order.create({\n      orderItems,\n      email,\n      orderStatus,\n      paymentStatus,\n      orderType,\n      orderAmount\n    });\n    await Table.updateOne({\n      tableId: tableId\n    }, {\n      $set: {\n        currentOrders: {\n          $push: {\n            orderItems,\n            email,\n            orderStatus,\n            paymentStatus,\n            orderType,\n            orderAmount\n          }\n        },\n        status: 'occupied'\n      }\n    });\n    console.log(\"here\");\n    const _length = order.length;\n    const message = _length === 0 ? \"Not found\" : \"success\";\n    const error = _length === 0 ? true : false;\n    const statusCode = _length === 0 ? 404 : 200;\n    return {\n      data: order,\n      error,\n      message,\n      statusCode\n    };\n  } catch (err) {\n    return {\n      data: [],\n      error: true,\n      message: \"Sorry an error occurred\",\n      statusCode: 500\n    };\n  }\n};\nmodule.exports = {\n  getOrdersService,\n  createOrderService\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJPcmRlciIsInJlcXVpcmUiLCJUYWJsZSIsInNzZSIsImdldE9yZGVyc1NlcnZpY2UiLCJvcmRlcnMiLCJmaW5kIiwiX2xlbmd0aCIsImxlbmd0aCIsIm1lc3NhZ2UiLCJlcnJvciIsInN0YXR1c0NvZGUiLCJkYXRhIiwiZXJyIiwiY3JlYXRlT3JkZXJTZXJ2aWNlIiwiYm9keSIsIm9yZGVySXRlbXMiLCJlbWFpbCIsIm9yZGVyU3RhdHVzIiwicGF5bWVudFN0YXR1cyIsIm9yZGVyVHlwZSIsIm9yZGVyQW1vdW50IiwidGFibGVJZCIsIm9yZGVyIiwiY3JlYXRlIiwidXBkYXRlT25lIiwiJHNldCIsImN1cnJlbnRPcmRlcnMiLCIkcHVzaCIsInN0YXR1cyIsImNvbnNvbGUiLCJsb2ciLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvcHJhc2hhbnQvRGVza3RvcC9zb2NpYWwtYmFja2VuZC9zZXJ2aWNlcy8iLCJzb3VyY2VzIjpbIm9yZGVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IE9yZGVyID0gcmVxdWlyZShcIi4uL21vZGVsL29yZGVyXCIpO1xuY29uc3QgVGFibGUgPSByZXF1aXJlKFwiLi4vbW9kZWwvdGFibGVcIik7XG4gIGNvbnN0IHNzZSA9IHJlcXVpcmUoXCIuLi9zc2VcIik7XG5cbmNvbnN0IGdldE9yZGVyc1NlcnZpY2UgPSBhc3luYyAoKSA9PiB7XG4gICAgLy8gICB0cnkge1xuICAgIC8vICAgICBjb25zdCBwb3N0cyA9IGF3YWl0IFBvc3RNb2RlbC5maW5kKCk7XG4gICAgLy8gICAgIGNvbnN0IF9sZW5ndGggPSBwb3N0cy5sZW5ndGg7XG4gICAgLy8gICAgIGNvbnN0IG1lc3NhZ2UgPSBfbGVuZ3RoID09PSAwID8gXCJOb3QgZm91bmRcIiA6IFwic3VjY2Vzc1wiO1xuICAgIC8vICAgICBjb25zdCBlcnJvciA9IF9sZW5ndGggPT09IDAgPyB0cnVlIDogZmFsc2U7XG4gICAgLy8gICAgIGNvbnN0IHN0YXR1c0NvZGUgPSBfbGVuZ3RoID09PSAwID8gNDA0IDogMjAwO1xuICAgIC8vICAgICByZXR1cm4geyBkYXRhOiBwb3N0cywgZXJyb3IsIG1lc3NhZ2UsIHN0YXR1c0NvZGUgfTtcbiAgICAvLyAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgLy8gICAgIHJldHVybiB7XG4gICAgLy8gICAgICAgZGF0YTogW10sXG4gICAgLy8gICAgICAgZXJyb3I6IHRydWUsXG4gICAgLy8gICAgICAgbWVzc2FnZTogXCJTb3JyeSBhbiBlcnJvciBvY2N1cnJlZFwiLFxuICAgIC8vICAgICAgIHN0YXR1c0NvZGU6IDUwMCxcbiAgICAvLyAgICAgfTtcbiAgICAvLyAgIH1cbiAgICB0cnkge1xuXG4gICAgICAgIGNvbnN0IG9yZGVycyA9IGF3YWl0IE9yZGVyLmZpbmQoKTtcbiAgICAgICAgY29uc3QgX2xlbmd0aCA9IG9yZGVycy5sZW5ndGg7XG4gICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBfbGVuZ3RoID09PSAwID8gXCJOb3QgZm91bmRcIiA6IFwic3VjY2Vzc1wiO1xuICAgICAgICBjb25zdCBlcnJvciA9IF9sZW5ndGggPT09IDAgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgIGNvbnN0IHN0YXR1c0NvZGUgPSBfbGVuZ3RoID09PSAwID8gNDA0IDogMjAwO1xuICAgICAgICByZXR1cm4geyBkYXRhOiBvcmRlcnMsIGVycm9yLCBtZXNzYWdlLCBzdGF0dXNDb2RlIH07XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBkYXRhOiBbXSxcbiAgICAgICAgICAgIGVycm9yOiB0cnVlLFxuICAgICAgICAgICAgbWVzc2FnZTogXCJTb3JyeSBhbiBlcnJvciBvY2N1cnJlZFwiLFxuICAgICAgICAgICAgc3RhdHVzQ29kZTogNTAwLFxuICAgICAgICB9O1xuICAgIH1cbn07XG5jb25zdCBjcmVhdGVPcmRlclNlcnZpY2UgPSBhc3luYyAoYm9keSkgPT4ge1xuICAgIHRyeSB7XG4gICAgICAgIGxldCB7IG9yZGVySXRlbXMsIGVtYWlsLCBvcmRlclN0YXR1cywgcGF5bWVudFN0YXR1cywgb3JkZXJUeXBlLCBvcmRlckFtb3VudCwgdGFibGVJZCB9ID0gYm9keVxuICAgICAgICBjb25zdCBvcmRlciA9IGF3YWl0IE9yZGVyLmNyZWF0ZSh7XG4gICAgICAgICAgICBvcmRlckl0ZW1zLCBlbWFpbCwgb3JkZXJTdGF0dXMsIHBheW1lbnRTdGF0dXMsIG9yZGVyVHlwZSwgb3JkZXJBbW91bnRcbiAgICAgICAgfSk7XG4gICAgICAgIGF3YWl0IFRhYmxlLnVwZGF0ZU9uZSh7IHRhYmxlSWQ6IHRhYmxlSWQgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAkc2V0OiB7XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRPcmRlcnM6IHsgJHB1c2g6IHsgb3JkZXJJdGVtcywgZW1haWwsIG9yZGVyU3RhdHVzLCBwYXltZW50U3RhdHVzLCBvcmRlclR5cGUsIG9yZGVyQW1vdW50IH0gfSxcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiAnb2NjdXBpZWQnXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiaGVyZVwiKVxuXG4gICAgICAgIGNvbnN0IF9sZW5ndGggPSBvcmRlci5sZW5ndGg7XG4gICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBfbGVuZ3RoID09PSAwID8gXCJOb3QgZm91bmRcIiA6IFwic3VjY2Vzc1wiO1xuICAgICAgICBjb25zdCBlcnJvciA9IF9sZW5ndGggPT09IDAgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgIGNvbnN0IHN0YXR1c0NvZGUgPSBfbGVuZ3RoID09PSAwID8gNDA0IDogMjAwO1xuXG4gICAgICAgIHJldHVybiB7IGRhdGE6IG9yZGVyLCBlcnJvciwgbWVzc2FnZSwgc3RhdHVzQ29kZSB9O1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZGF0YTogW10sXG4gICAgICAgICAgICBlcnJvcjogdHJ1ZSxcbiAgICAgICAgICAgIG1lc3NhZ2U6IFwiU29ycnkgYW4gZXJyb3Igb2NjdXJyZWRcIixcbiAgICAgICAgICAgIHN0YXR1c0NvZGU6IDUwMCxcbiAgICAgICAgfTtcbiAgICB9XG59O1xubW9kdWxlLmV4cG9ydHMgPSB7XG4gICAgZ2V0T3JkZXJzU2VydmljZSxcbiAgICBjcmVhdGVPcmRlclNlcnZpY2Vcbn07Il0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxLQUFLLEdBQUdDLE9BQU8sQ0FBQyxnQkFBZ0IsQ0FBQztBQUN2QyxNQUFNQyxLQUFLLEdBQUdELE9BQU8sQ0FBQyxnQkFBZ0IsQ0FBQztBQUNyQyxNQUFNRSxHQUFHLEdBQUdGLE9BQU8sQ0FBQyxRQUFRLENBQUM7QUFFL0IsTUFBTUcsZ0JBQWdCLEdBQUcsWUFBWTtFQUNqQztFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQSxJQUFJO0lBRUEsTUFBTUMsTUFBTSxHQUFHLE1BQU1MLEtBQUssQ0FBQ00sSUFBSSxFQUFFO0lBQ2pDLE1BQU1DLE9BQU8sR0FBR0YsTUFBTSxDQUFDRyxNQUFNO0lBQzdCLE1BQU1DLE9BQU8sR0FBR0YsT0FBTyxLQUFLLENBQUMsR0FBRyxXQUFXLEdBQUcsU0FBUztJQUN2RCxNQUFNRyxLQUFLLEdBQUdILE9BQU8sS0FBSyxDQUFDLEdBQUcsSUFBSSxHQUFHLEtBQUs7SUFDMUMsTUFBTUksVUFBVSxHQUFHSixPQUFPLEtBQUssQ0FBQyxHQUFHLEdBQUcsR0FBRyxHQUFHO0lBQzVDLE9BQU87TUFBRUssSUFBSSxFQUFFUCxNQUFNO01BQUVLLEtBQUs7TUFBRUQsT0FBTztNQUFFRTtJQUFXLENBQUM7RUFDdkQsQ0FBQyxDQUFDLE9BQU9FLEdBQUcsRUFBRTtJQUNWLE9BQU87TUFDSEQsSUFBSSxFQUFFLEVBQUU7TUFDUkYsS0FBSyxFQUFFLElBQUk7TUFDWEQsT0FBTyxFQUFFLHlCQUF5QjtNQUNsQ0UsVUFBVSxFQUFFO0lBQ2hCLENBQUM7RUFDTDtBQUNKLENBQUM7QUFDRCxNQUFNRyxrQkFBa0IsR0FBRyxNQUFPQyxJQUFJLElBQUs7RUFDdkMsSUFBSTtJQUNBLElBQUk7TUFBRUMsVUFBVTtNQUFFQyxLQUFLO01BQUVDLFdBQVc7TUFBRUMsYUFBYTtNQUFFQyxTQUFTO01BQUVDLFdBQVc7TUFBRUM7SUFBUSxDQUFDLEdBQUdQLElBQUk7SUFDN0YsTUFBTVEsS0FBSyxHQUFHLE1BQU12QixLQUFLLENBQUN3QixNQUFNLENBQUM7TUFDN0JSLFVBQVU7TUFBRUMsS0FBSztNQUFFQyxXQUFXO01BQUVDLGFBQWE7TUFBRUMsU0FBUztNQUFFQztJQUM5RCxDQUFDLENBQUM7SUFDRixNQUFNbkIsS0FBSyxDQUFDdUIsU0FBUyxDQUFDO01BQUVILE9BQU8sRUFBRUE7SUFBUSxDQUFDLEVBQ3RDO01BQ0lJLElBQUksRUFBRTtRQUNGQyxhQUFhLEVBQUU7VUFBRUMsS0FBSyxFQUFFO1lBQUVaLFVBQVU7WUFBRUMsS0FBSztZQUFFQyxXQUFXO1lBQUVDLGFBQWE7WUFBRUMsU0FBUztZQUFFQztVQUFZO1FBQUUsQ0FBQztRQUNuR1EsTUFBTSxFQUFFO01BQ1o7SUFDSixDQUFDLENBQUM7SUFDRkMsT0FBTyxDQUFDQyxHQUFHLENBQUMsTUFBTSxDQUFDO0lBRXZCLE1BQU14QixPQUFPLEdBQUdnQixLQUFLLENBQUNmLE1BQU07SUFDNUIsTUFBTUMsT0FBTyxHQUFHRixPQUFPLEtBQUssQ0FBQyxHQUFHLFdBQVcsR0FBRyxTQUFTO0lBQ3ZELE1BQU1HLEtBQUssR0FBR0gsT0FBTyxLQUFLLENBQUMsR0FBRyxJQUFJLEdBQUcsS0FBSztJQUMxQyxNQUFNSSxVQUFVLEdBQUdKLE9BQU8sS0FBSyxDQUFDLEdBQUcsR0FBRyxHQUFHLEdBQUc7SUFFNUMsT0FBTztNQUFFSyxJQUFJLEVBQUVXLEtBQUs7TUFBRWIsS0FBSztNQUFFRCxPQUFPO01BQUVFO0lBQVcsQ0FBQztFQUN0RCxDQUFDLENBQUMsT0FBT0UsR0FBRyxFQUFFO0lBQ1YsT0FBTztNQUNIRCxJQUFJLEVBQUUsRUFBRTtNQUNSRixLQUFLLEVBQUUsSUFBSTtNQUNYRCxPQUFPLEVBQUUseUJBQXlCO01BQ2xDRSxVQUFVLEVBQUU7SUFDaEIsQ0FBQztFQUNMO0FBQ0osQ0FBQztBQUNEcUIsTUFBTSxDQUFDQyxPQUFPLEdBQUc7RUFDYjdCLGdCQUFnQjtFQUNoQlU7QUFDSixDQUFDIn0=","map":{"version":3,"names":["Order","require","Table","sse","getOrdersService","orders","find","_length","length","message","error","statusCode","data","err","createOrderService","body","orderItems","email","orderStatus","paymentStatus","orderType","orderAmount","tableId","order","create","updateOne","$set","currentOrders","$push","status","console","log","module","exports"],"sourceRoot":"/Users/prashant/Desktop/social-backend/services/","sources":["order.js"],"sourcesContent":["const Order = require(\"../model/order\");\nconst Table = require(\"../model/table\");\n  const sse = require(\"../sse\");\n\nconst getOrdersService = async () => {\n    //   try {\n    //     const posts = await PostModel.find();\n    //     const _length = posts.length;\n    //     const message = _length === 0 ? \"Not found\" : \"success\";\n    //     const error = _length === 0 ? true : false;\n    //     const statusCode = _length === 0 ? 404 : 200;\n    //     return { data: posts, error, message, statusCode };\n    //   } catch (error) {\n    //     return {\n    //       data: [],\n    //       error: true,\n    //       message: \"Sorry an error occurred\",\n    //       statusCode: 500,\n    //     };\n    //   }\n    try {\n\n        const orders = await Order.find();\n        const _length = orders.length;\n        const message = _length === 0 ? \"Not found\" : \"success\";\n        const error = _length === 0 ? true : false;\n        const statusCode = _length === 0 ? 404 : 200;\n        return { data: orders, error, message, statusCode };\n    } catch (err) {\n        return {\n            data: [],\n            error: true,\n            message: \"Sorry an error occurred\",\n            statusCode: 500,\n        };\n    }\n};\nconst createOrderService = async (body) => {\n    try {\n        let { orderItems, email, orderStatus, paymentStatus, orderType, orderAmount, tableId } = body\n        const order = await Order.create({\n            orderItems, email, orderStatus, paymentStatus, orderType, orderAmount\n        });\n        await Table.updateOne({ tableId: tableId },\n            {\n                $set: {\n                    currentOrders: { $push: { orderItems, email, orderStatus, paymentStatus, orderType, orderAmount } },\n                    status: 'occupied'\n                }\n            })\n            console.log(\"here\")\n\n        const _length = order.length;\n        const message = _length === 0 ? \"Not found\" : \"success\";\n        const error = _length === 0 ? true : false;\n        const statusCode = _length === 0 ? 404 : 200;\n\n        return { data: order, error, message, statusCode };\n    } catch (err) {\n        return {\n            data: [],\n            error: true,\n            message: \"Sorry an error occurred\",\n            statusCode: 500,\n        };\n    }\n};\nmodule.exports = {\n    getOrdersService,\n    createOrderService\n};"],"mappings":"AAAA,MAAMA,KAAK,GAAGC,OAAO,CAAC,gBAAgB,CAAC;AACvC,MAAMC,KAAK,GAAGD,OAAO,CAAC,gBAAgB,CAAC;AACrC,MAAME,GAAG,GAAGF,OAAO,CAAC,QAAQ,CAAC;AAE/B,MAAMG,gBAAgB,GAAG,YAAY;EACjC;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA,IAAI;IAEA,MAAMC,MAAM,GAAG,MAAML,KAAK,CAACM,IAAI,EAAE;IACjC,MAAMC,OAAO,GAAGF,MAAM,CAACG,MAAM;IAC7B,MAAMC,OAAO,GAAGF,OAAO,KAAK,CAAC,GAAG,WAAW,GAAG,SAAS;IACvD,MAAMG,KAAK,GAAGH,OAAO,KAAK,CAAC,GAAG,IAAI,GAAG,KAAK;IAC1C,MAAMI,UAAU,GAAGJ,OAAO,KAAK,CAAC,GAAG,GAAG,GAAG,GAAG;IAC5C,OAAO;MAAEK,IAAI,EAAEP,MAAM;MAAEK,KAAK;MAAED,OAAO;MAAEE;IAAW,CAAC;EACvD,CAAC,CAAC,OAAOE,GAAG,EAAE;IACV,OAAO;MACHD,IAAI,EAAE,EAAE;MACRF,KAAK,EAAE,IAAI;MACXD,OAAO,EAAE,yBAAyB;MAClCE,UAAU,EAAE;IAChB,CAAC;EACL;AACJ,CAAC;AACD,MAAMG,kBAAkB,GAAG,MAAOC,IAAI,IAAK;EACvC,IAAI;IACA,IAAI;MAAEC,UAAU;MAAEC,KAAK;MAAEC,WAAW;MAAEC,aAAa;MAAEC,SAAS;MAAEC,WAAW;MAAEC;IAAQ,CAAC,GAAGP,IAAI;IAC7F,MAAMQ,KAAK,GAAG,MAAMvB,KAAK,CAACwB,MAAM,CAAC;MAC7BR,UAAU;MAAEC,KAAK;MAAEC,WAAW;MAAEC,aAAa;MAAEC,SAAS;MAAEC;IAC9D,CAAC,CAAC;IACF,MAAMnB,KAAK,CAACuB,SAAS,CAAC;MAAEH,OAAO,EAAEA;IAAQ,CAAC,EACtC;MACII,IAAI,EAAE;QACFC,aAAa,EAAE;UAAEC,KAAK,EAAE;YAAEZ,UAAU;YAAEC,KAAK;YAAEC,WAAW;YAAEC,aAAa;YAAEC,SAAS;YAAEC;UAAY;QAAE,CAAC;QACnGQ,MAAM,EAAE;MACZ;IACJ,CAAC,CAAC;IACFC,OAAO,CAACC,GAAG,CAAC,MAAM,CAAC;IAEvB,MAAMxB,OAAO,GAAGgB,KAAK,CAACf,MAAM;IAC5B,MAAMC,OAAO,GAAGF,OAAO,KAAK,CAAC,GAAG,WAAW,GAAG,SAAS;IACvD,MAAMG,KAAK,GAAGH,OAAO,KAAK,CAAC,GAAG,IAAI,GAAG,KAAK;IAC1C,MAAMI,UAAU,GAAGJ,OAAO,KAAK,CAAC,GAAG,GAAG,GAAG,GAAG;IAE5C,OAAO;MAAEK,IAAI,EAAEW,KAAK;MAAEb,KAAK;MAAED,OAAO;MAAEE;IAAW,CAAC;EACtD,CAAC,CAAC,OAAOE,GAAG,EAAE;IACV,OAAO;MACHD,IAAI,EAAE,EAAE;MACRF,KAAK,EAAE,IAAI;MACXD,OAAO,EAAE,yBAAyB;MAClCE,UAAU,EAAE;IAChB,CAAC;EACL;AACJ,CAAC;AACDqB,MAAM,CAACC,OAAO,GAAG;EACb7B,gBAAgB;EAChBU;AACJ,CAAC"}},"mtime":1671272811289}}